require.config({paths:{common:"common.min",jquery:"jquery-3.2.1",swiper:"swiper.min"}}),define(["common","jquery","swiper"],function(x,b,e){x.init();var w={s:["","\u680b","\u95f4","\u5957","\u4eba"],env:"dev",server:{dev:"//dev.xiangdao.info",pro:"//www.xiangdao.info"},videoIndexArr:[]};w.id=x.parseQueryString().id;var E=new e(".swiper-container-bed",{slidesPerView:"auto",spaceBetween:30,init:!1});w.q=function(e){return document.querySelector(e)},w.judgeHeight=function(e){var i=e.clientHeight;e.style.height="auto",e.style.display="block",e.clientHeight<=i?e.nextElementSibling.style.display="none":e.removeAttribute("style")},w.init=function(){w.initData(),w.eventBind()},w.initData=function(){var y=w.q(".swiper-pagination"),q=new e(".swiper-container-head",{pagination:{el:".swiper-pagination",type:"fraction"},on:{transitionEnd:function(){var i=this;0<w.videoIndexArr.length?w.videoIndexArr.forEach(function(e){e.index===i.activeIndex?y.classList.add("video"):y.classList.remove("video")}):y.classList.remove("video");var e=document.querySelectorAll("video");if(e&&0<e.length)for(var n=0;n<e.length;n++)e[n].pause()}}});b.ajax({url:w.server[w.env]+"/xiangdao-api/api/tuan/tuan_details",method:"POST",dataType:"json",async:!1,headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify({tuanId:w.id}),success:function(e){if(console.log(e),0===e.status){var a=e.json,i=w.q("#baseLiveNumber"),n=w.q(".hc-ver"),t=w.q(".hc-tit"),s=w.q(".hc-tags");if(n.style.display="flex",n.innerText="\u623f\u6e90\u5df2\u8ba4\u8bc1",n.classList.add("verified"),t.innerText=a.infoTitle,a.tagName){var r=a.tagName.split(","),l="";r.forEach(function(e){l+='<div class="hc-tag">'+e+"</div>"}),s.innerHTML=l}var o=[null,"\u5c42","\u5367","\u6d74","\u53a8","\u536b","\u5ba2\u5385","\u9910\u5385","\u4e66\u623f","\u9633\u53f0"],c=[{id:1,name:"\u5927\u5e8a",icon:"icon_bed.png",bed:[],list:[null,"2*1.8m","2*1.5m","1.8*1.5m","2*2m","2*1.6m","2.2*2.2m"]},{id:2,name:"\u5355\u4eba\u5e8a",icon:"icon_sbed.png",bed:[],list:[null,"2*1m","2*1.2m","1.9*2m","2*0.8m","2*1.35m","2*1.1m","2*1.3m"]},{id:3,name:"\u53cc\u5c42\u5e8a",icon:"icon_dbed.png",bed:[],list:[null,"0.9*1.9m\u4e0a\uff0c1.2*1.9m\u4e0b","1.2*1.9m\u4e0a\uff0c1.5*1.9m\u4e0b","1.35*1.9m\u4e0a\uff0c1.5*1.9m\u4e0b","0.9*1.8m","1*1.9m","1.2*1.9m","1.8*1.2m"]},{id:4,name:"\u6c99\u53d1\u5e8a",icon:"icon_sofa.png",bed:[],list:[null,"2*1.2m","2*1.5m"]},{id:5,name:"\u5706\u5e8a",icon:"icon_cbed.png",bed:[],list:[null,"\u76f4\u5f842m","\u76f4\u5f842.2m"]}],d=a.baseHouseType.split(",");if(d&&0<d.length){var u="";d.forEach(function(e,i){var n=e.split("-");0<n[1]&&(u+=n[1]+o[parseInt(n[0])],i+1<d.length&&(u+="/")),"2"===n[0]&&(w.q("#roomCount").innerText=n[1])}),w.q("#baseHouseType").innerText=u}if(a.baseBedType){var p=a.baseBedType.split(",");p&&0<p.length&&p.forEach(function(e){var i=e.split("-");c.forEach(function(e){parseInt(i[0])===e.id&&e.bed.push(i)})})}var v=w.q("#hcInfo2");c.forEach(function(i){var n="";if(0<i.bed.length){n+='<div class="hci-tli">\n',n+='<img class="hci-icon" src="img/'+i.icon+'" alt />',n+='<div class="hci-text">'+i.bed[0][2]+"\u5f20"+i.name+"</div></div>",n+='<div class="hci-trli">',i.bed.forEach(function(e){n+='<div class="hci-trli-row"><span>('+i.list[e[1]]+")</span>&times;"+e[2]+"</div>"}),n+="</div></div>\n";var e=document.createElement("div");e.classList.add("hci-tli-wrap"),e.classList.add("swiper-slide"),e.innerHTML=n,v.appendChild(e),E.update(),E.init()}}),i.innerText=a.baseLiveNumber;var m=w.q(".rule-other"),h=w.q(".rule-pet"),f=w.q(".rule-party");if(a.tuanBeginTime&&a.tuanEndTime&&(w.q("#tuanBeginTime").innerText=w.parseTime(a.tuanBeginTime),w.q("#tuanEndTime").innerText=w.parseTime(a.tuanEndTime)),a.ruleRequireJson?(m.innerText=a.ruleRequireJson,m.style.display="flex"):m.style.display="none",h.innerText=0===a.ruleIsAllowPet?"\u4e0d\u5141\u8bb8\u5e26\u5ba0\u7269":"\u5141\u8bb8\u5e26\u5ba0\u7269",f.innerText=0===a.ruleIsAllowParty?"\u4e0d\u5141\u8bb8\u4e3e\u529e\u6d3b\u52a8\u6216\u805a\u4f1a":"\u5141\u8bb8\u4e3e\u529e\u6d3b\u52a8\u6216\u805a\u4f1a",a.houseId&&x.request({url:w.server[w.env]+"/xiangdao-api/api/house/album_list/"+a.houseId,method:"GET",success:function(e){var i=e.json;if(i&&0<i.length){console.log(e);var t="";i.forEach(function(n,e){if(n.url){var i=n.url.split(",");0<i.length&&i.forEach(function(e,i){t+='<div class="swiper-slide">',1===n.type&&0===i?(t+='<video id="video'+n.id+'" class="head-video-li" preload="auto" controls  webkit-playsinline="true"\n playsinline="true"\n x5-playsinline="true"\n x5-video-player-type="h5"\n x5-video-player-fullscreen=""\n x5-video-orientation="portraint"\n x-webkit-airplay="true"\n controls="controls" src="'+e+'" poster="'+e+'?vframe/jpg/offset/2/w/640/h/360" />',w.videoIndexArr.push({index:i,item:e})):t+='<img class="head-img-li" src="'+e+'" alt />',t+="</div>"})}0===e&&1===n.type&&y.classList.add("video")}),w.q("#headImgs").innerHTML=t,q.update()}}}),b.ajax({url:w.server[w.env]+"/xiangdao-api/api/houseEditor/get_house_icon_group",success:function(e){console.log(e);var i=e.json;if(i&&0<i.length){var n="";n+='<div class="ist">\n',n+='<div class="ist-r">\n';var s=a.profileHouseIcon.split(",");i.forEach(function(a){var e="";a.list.forEach(function(n){var t=!1;s&&0<s.length&&s.forEach(function(e){var i=e.split("-");i[0]==a.type&&i[1]==n.iconSeq&&(t=!0)}),t&&(e+='<div class="ist-li '+(t?"sel":"")+'" data-id="'+n.iconSeq+'">'+n.iconName+"</div>")}),n+=e}),n+="</div>",n+="</div>";var t=w.q("#insWrap");t.innerHTML=n,w.judgeHeight(t)}}}),a.faqCount){b(".ask-nodata").hide(),b("#askShowAll").show();var g='<div class="ask-li">\n                <div class="ali-t">\n                    <img class="ali-avatar" src="'+a.lastFaqAvatar+'" alt />\n                    <div class="ali-name">'+a.lastFaqNickName+'</div>\n                </div>\n                <div class="ali-tit">'+a.lastFaqTitle+"</div>\n            </div>";b("#askList").html(g)}if(w.q("#joinPersonNumber").innerText=a.joinPersonNumber||0,w.q("#phone").setAttribute("href","tel:"+a.rulePhone),a.tuanNotice&&(w.q("#tuanNotice").innerHTML=a.tuanNotice),a.surplusTimestamp&&0<a.surplusTimestamp){w.surplusTimestamp=a.surplusTimestamp,restTime.innerHTML=w.formatTime(a.surplusTimestamp);var T=setInterval(function(){var e=w.surplusTimestamp-1,i=w.formatTime(0<e?e:0);w.q("#restDays").innerText=i.day,w.q("#restTime").innerHTML=i.time,(w.surplusTimestamp=e)<=0&&clearInterval(T)},1e3)}a.tuanPrice&&(w.q("#tuanPrice").innerText=a.tuanPrice),a.singleTuanPrice&&(w.q("#singleTuanPrice").innerText=a.singleTuanPrice),a.doubleTuanPrice&&(w.q("#doubleTuanPrice").innerText=a.doubleTuanPrice)}}})},w.eventBind=function(){var e=document.querySelectorAll(".pan-showall");if(e&&0<e.length)for(var i=0;i<e.length;i++)e[i].addEventListener("click",function(){var e=this.previousElementSibling;e&&e.classList.add("showAll"),this.style.display="none"},!1);var n=document.querySelectorAll(".pan-showall2");if(n&&0<n.length)for(var t=0;t<n.length;t++)n[t].addEventListener("click",function(){var e=this.previousElementSibling;"1"!==this.dataset.switch?(this.innerText="\u6536\u8d77 >>",this.dataset.switch="1",e&&e.classList.add("showAll")):(this.innerText="\u8be6\u60c5 >>",this.dataset.switch="0",e&&e.classList.remove("showAll"))},!1);var a=document.querySelectorAll(".link");if(a&&0<a.length)for(var s=0;s<a.length;s++)a[s].addEventListener("click",function(){openApp()},!1)},w.formatTime=function(e){var i=parseInt(e/86400),n=parseInt(e%86400/3600),t=parseInt(e%3600/60),a=parseInt(e%60);return n<10&&(n="0"+n),t<10&&(t="0"+t),a<10&&(a="0"+a),{day:i,time:"<span>"+n+"</span>:<span>"+t+"</span>:<span>"+a+"</span>"}},w.parseTime=function(e){if(e){var i=new Date(e);return i.getMonth()+1+"\u6708"+i.getDate()+"\u65e5"}return""},w.init()});