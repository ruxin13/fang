require.config({paths:{common:"common.min",jquery:"jquery-3.2.1",swiper:"swiper.min"}}),define(["common","jquery","swiper"],function(e,i,n){e.init();var t={env:"dev",server:{dev:"//dev.xiangdao.info",pro:"//www.xiangdao.info"},videoIndexArr:[]};t.id=e.parseQueryString().houseId;var a=new n(".swiper-container-bed",{slidesPerView:"auto",spaceBetween:30,init:!1});t.q=function(e){return document.querySelector(e)},t.judgeHeight=function(e){var i=e.clientHeight;e.style.height="auto",e.style.display="block",i>=e.clientHeight?e.nextElementSibling.style.display="none":e.removeAttribute("style")};var s=t.q(".swiper-pagination"),r=new n(".swiper-container-head",{pagination:{el:".swiper-pagination",type:"fraction"},on:{transitionEnd:function(){var e=this;t.videoIndexArr.length>0?t.videoIndexArr.forEach(function(i){i.index===e.activeIndex?s.classList.add("video"):s.classList.remove("video")}):s.classList.remove("video");var i=document.querySelectorAll("video");if(i&&i.length>0)for(var n=0;n<i.length;n++)i[n].pause()}}});e.request({url:t.server[t.env]+"/xiangdao-api/api/house/album_list/"+t.id,method:"GET",success:function(e){var i=e.json;if(i&&i.length>0){var n="";i.forEach(function(e,i){if(e.url){var a=e.url.split(",");a.length>0&&a.forEach(function(i,a){n+='<div class="swiper-slide">',1===e.type&&0===a?(n+='<video id="video'+e.id+'" class="head-video-li" preload="auto" controls  webkit-playsinline="true"\n playsinline="true"\n x5-playsinline="true"\n x5-video-player-type="h5"\n x5-video-player-fullscreen=""\n x5-video-orientation="portraint"\n x-webkit-airplay="true"\n controls="controls" src="'+i+'" poster="'+i+'?vframe/jpg/offset/2/w/640/h/360" />',t.videoIndexArr.push({index:a,item:i})):n+='<img class="head-img-li" src="'+i+'" alt />',n+="</div>"})}0===i&&1===e.type&&s.classList.add("video")}),t.q("#headImgs").innerHTML=n,r.update()}}}),e.request({url:t.server[t.env]+"/xiangdao-api/api/house/details/"+t.id,method:"GET",success:function(e){var n=e.json,s=t.q(".hc-ver"),r=t.q(".hc-user"),l=t.q("#houseNo"),o=t.q("#profileStr"),d=t.q(".hc-tit"),c=t.q("#baseIndoorArea"),v=t.q("#baseOrientation"),p=t.q("#baseEstablishDate"),u=t.q("#profileRentMode"),h=t.q("#baseCourtyardArea"),f=t.q("#ownerAvatar2"),m=t.q("#ownerNickName"),y=t.q("#ownerHouseIsAuthentication2"),g=t.q("#baseOwnerBrief"),b=t.q("#ruleYearMoney"),x=t.q("#baseLiveNumber"),q=t.q("#floor"),T=t.q("#infoBrief"),w=t.q("#otherDesc"),E=t.q("#mpConfirm"),A=t.q(".nearby"),I=[null,"\u5c42","\u5367","\u6d74","\u53a8","\u536b","\u5ba2\u5385","\u9910\u5385","\u4e66\u623f","\u9633\u53f0"],N=[{id:1,name:"\u5927\u5e8a",icon:"icon_bed.png",bed:[],list:[null,"2*1.8m","2*1.5m","1.8*1.5m","2*2m","2*1.6m","2.2*2.2m"]},{id:2,name:"\u5355\u4eba\u5e8a",icon:"icon_sbed.png",bed:[],list:[null,"2*1m","2*1.2m","1.9*2m","2*0.8m","2*1.35m","2*1.1m","2*1.3m"]},{id:3,name:"\u53cc\u5c42\u5e8a",icon:"icon_dbed.png",bed:[],list:[null,"0.9*1.9m\u4e0a\uff0c1.2*1.9m\u4e0b","1.2*1.9m\u4e0a\uff0c1.5*1.9m\u4e0b","1.35*1.9m\u4e0a\uff0c1.5*1.9m\u4e0b","0.9*1.8m","1*1.9m","1.2*1.9m","1.8*1.2m"]},{id:4,name:"\u6c99\u53d1\u5e8a",icon:"icon_sofa.png",bed:[],list:[null,"2*1.2m","2*1.5m"]},{id:5,name:"\u5706\u5e8a",icon:"icon_cbed.png",bed:[],list:[null,"\u76f4\u5f842m","\u76f4\u5f842.2m"]}],S=[null,"\u9760\u8fd1\u5c0f\u533a\u5185\u4e3b\u8def","\u9760\u8fd1\u4e3b\u8def","\u9760\u8fd1\u505c\u8f66\u573a","\u9760\u8fd1\u516c\u56ed\u6216\u5e7f\u573a","\u9760\u8fd1\u591c\u5e02","\u5468\u8fb9\u8f83\u5b89\u9759","\u5468\u8fb9\u5f88\u5b89\u9759","\u9760\u8fd1\u98de\u673a\u573a","\u9760\u8fd1\u5c0f\u533a\u51fa\u5165\u53e3"],L=[null,"\u5c0f\u533a\u5185\u90e8","\u53ef\u89c1\u82b1\u56ed","\u53ef\u89c1\u5c71\u666f","\u53ef\u89c1\u6e56\u666f","\u53ef\u89c1\u6c5f\u666f","\u53ef\u89c1\u6d77\u666f","\u53ef\u89c1\u6811\u6797","\u53ef\u89c1\u8857\u666f","\u53ef\u89c1\u6e38\u6cf3\u6c60","\u53ef\u89c1\u9ad8\u5c14\u592b\u7403\u573a"];if(n.baseBedType){var j=n.baseBedType.split(",");j&&j.length>0&&j.forEach(function(e){var i=e.split("-");N.forEach(function(e){parseInt(i[0])===e.id&&e.bed.push(i)})})}if(n.baseIndoorScenery){var k="";n.baseIndoorScenery.split(",").forEach(function(e){k+='<div class="hci-label">'+L[parseInt(e)]+"</div>"}),i("#baseScenery").html(k)}else i("#baseIndoorScenery").hide();if(n.baseNoise){var H="";n.baseNoise.split(",").forEach(function(e){H+='<div class="hci-label">'+S[parseInt(e)]+"</div>"}),i("#baseNoise").html(H)}else i("#baseNoiseWrap").hide();A.addEventListener("click",function(){location.href="video.html?id="+n.villageId},!1),i.ajax({url:t.server[t.env]+"/xiangdao-api/api/house/house_list",method:"POST",dataType:"json",headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify({villageId:n.villageId}),success:function(e){if(0===e.status){var n=e.json.result;if(n&&n.length>0){var a="";n.forEach(function(e){a+='<div class="hli" data-id="'+e.houseId+'">\n                <img class="hli-img" src="'+e.infoCover+'" alt />\n                <div class="hli-stit">'+e.profileStr+'</div>\n                <div class="hli-tit">'+e.infoTitle+'</div>\n                <div class="hli-price">\uffe5<span>'+e.ruleMonthMoney+"</span>/\u6708</div>\n            </div>"}),t.q("#hlist").innerHTML=a,i(".hli").on("click",function(){var e=i(this).data("id");location.href="house_details.html?houseId="+e})}var s=document.querySelectorAll(".link");if(s&&s.length>0)for(var r=0;r<s.length;r++)s[r].addEventListener("click",function(){openApp()},!1)}}});var M=t.q("#hcInfo2");N.forEach(function(e){var i="";if(e.bed.length>0){i+='<div class="hci-tli">\n',i+='<img class="hci-icon" src="img/'+e.icon+'" alt />',i+='<div class="hci-text">'+e.bed[0][2]+"\u5f20"+e.name+"</div></div>",i+='<div class="hci-trli">',e.bed.forEach(function(n){i+='<div class="hci-trli-row"><span>('+e.list[n[1]]+")</span>&times;"+n[2]+"</div>"}),i+="</div></div>\n";var n=document.createElement("div");n.classList.add("hci-tli-wrap"),n.classList.add("swiper-slide"),n.innerHTML=i,M.appendChild(n),a.update(),a.init()}});var C=n.baseHouseType.split(",");if(C&&C.length>0){var O="";C.forEach(function(e,i){var n=e.split("-");n[1]>0&&(O+=n[1]+I[parseInt(n[0])],i+1<C.length&&(O+="/")),"2"===n[0]&&(t.q("#roomCount").innerText=n[1]),"1"===n[0]&&(q.innerText=n[1]),0===i&&n[2]&&(q.innerText=n[1]+"~"+n[2])}),t.q("#baseHouseType").innerText=O}s.style.display="flex",s.innerText="\u623f\u6e90\u5df2\u8ba4\u8bc1",s.classList.add("verified"),r.src=n.ownerAvatar,l.innerText=n.houseNo,o.innerText=n.profileStr,d.innerText=n.infoTitle,c.innerText=n.baseIndoorArea,v.innerText=n.baseOrientation,p.innerText=new Date(n.baseEstablishDate).getFullYear(),u.innerText=[null,"\u6574\u680b\u51fa\u79df","\u72ec\u7acb\u51fa\u79df","\u6574\u5957\u51fa\u79df"][n.profileRentMode],f.src=n.ownerAvatar,m.innerText=n.ownerNickName,n.baseOwnerBrief?(g.innerText=n.baseOwnerBrief,t.judgeHeight(g)):(g.style.display="none",g.nextElementSibling.style.display="none",t.q(".pan-user").style.marginBottom="0px"),b.innerText=n.ruleMonthMoney,T.innerText=n.infoBrief,t.judgeHeight(T),x.innerText=n.baseLiveNumber,n.ruleOtherMoneyDesc&&"undefined"!==n.ruleOtherMoneyDesc&&(w.innerText=n.ruleOtherMoneyDesc),phone.setAttribute("href","tel:"+n.rulePhone),E.addEventListener("click",function(){this.parentNode.parentNode.style.display="none"},!1),1==n.ownerHouseIsAuthentication2?y.innerText="\u5df2\u5b9e\u540d\u8ba4\u8bc1":y.innerText="\u672a\u5b9e\u540d\u8ba4\u8bc1";var _=t.q(".rule-other"),B=t.q(".rule-pet"),R=t.q(".rule-party");n.ruleRequireJson?(_.innerText=n.ruleRequireJson,_.style.display="flex"):_.style.display="none",B.innerText=0===n.ruleIsAllowPet?"\u4e0d\u5141\u8bb8\u5e26\u5ba0\u7269":"\u5141\u8bb8\u5e26\u5ba0\u7269",R.innerText=0===n.ruleIsAllowParty?"\u4e0d\u5141\u8bb8\u4e3e\u529e\u6d3b\u52a8\u6216\u805a\u4f1a":"\u5141\u8bb8\u4e3e\u529e\u6d3b\u52a8\u6216\u805a\u4f1a",i.ajax({url:t.server[t.env]+"/xiangdao-api/api/house/faq_list",method:"POST",dataType:"json",async:!1,headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify({houseId:t.id,pageNo:1,pageSize:6}),success:function(e){var n=e.json.result;e.json.totalCount>2&&(n.length>2&&(n.length=2),i("#askShowAll").show());var a="";n&&n.length>0&&(t.q(".ask-nodata").style.display="none",n.forEach(function(e){var i="";if(e.replyCount>0&&(i+='<div class="ali-reply">\n                    <div class="ali-rep-t">\n                        <img class="ali-rep-avatar" src="'+e.lastReplyAvatar+'" alt />\n                        <div class="ali-rep-name">'+e.lastReplyNickName+'</div>\n                    </div>\n                    <div class="ali-rep-tit">'+e.lastReplyTitle+"</div>\n                </div>\n",e.replyCount>1)){var n=e.avatarUrl.split(","),t="";n&&n.length>0&&(n.shift(),n.length>4&&(n.length=4),n.forEach(function(e){t+='<img class="alp-avatar" src="'+e+'" alt />'})),i+='<div class="ali-rep-more">\n                    <div class="alp-avatars">\n'+t+'                    </div>\n                    <div class="alp-txt">'+e.lastReplyNickName+"\u7b49"+(e.replyCount-1)+"\u4eba\u4e5f\u8fdb\u884c\u4e86\u56de\u7b54</div>\n                </div>"}a+='<div class="ask-li" data-id="'+e.faqId+'">\n                <div class="ali-t">\n                    <img class="ali-avatar" src="'+e.avatar+'" alt />\n                    <div class="ali-name">'+e.nickName+'</div>\n                </div>\n                <div class="ali-tit">'+e.title+"</div>\n"+i+"            </div>"}),i("#askList").html(a))}}),n.baseCourtyardArea>0?(h.innerText=n.baseCourtyardArea,h.parentNode.parentNode.style.display="flex"):h.parentNode.parentNode.style.display="none",t.q("#togglePrice").addEventListener("click",function(){var e=t.q(".multi-price"),i=e.style.display;e.style.display="none"===i?"block":"none"},!1),i.ajax({url:t.server[t.env]+"/xiangdao-api/api/houseEditor/get_house_icon_group",success:function(e){var i=e.json;if(i&&i.length>0){var a="";a+='<div class="ist">\n',a+='<div class="ist-r">\n';var s=n.profileHouseIcon.split(",");i.forEach(function(e){var i="";e.list.forEach(function(n){var t=!1;s&&s.length>0&&s.forEach(function(i){var a=i.split("-");a[0]==e.type&&a[1]==n.iconSeq&&(t=!0)}),t&&(i+='<div class="ist-li '+(t?"sel":"")+'" data-id="'+n.iconSeq+'">'+n.iconName+"</div>")}),a+=i}),a+="</div>",a+="</div>";var r=t.q("#insWrap");r.innerHTML=a,t.judgeHeight(r)}}})}});var l=document.querySelectorAll(".pan-showall");if(l&&l.length>0)for(var o=0;o<l.length;o++)l[o].addEventListener("click",function(){var e=this.previousElementSibling;e&&e.classList.add("showAll"),this.style.display="none"},!1);var d=document.querySelectorAll(".pan-showall2");if(d&&d.length>0)for(var c=0;c<d.length;c++)d[c].addEventListener("click",function(){var e=this.previousElementSibling;"1"!==this.dataset.switch?(this.innerText="\u6536\u8d77 >>",this.dataset.switch="1",e&&e.classList.add("showAll")):(this.innerText="\u8be6\u60c5 >>",this.dataset.switch="0",e&&e.classList.remove("showAll"))},!1);var v=document.querySelectorAll(".link");if(v&&v.length>0)for(var p=0;p<v.length;p++)v[p].addEventListener("click",function(){openApp()},!1)});