require.config({paths:{common:"common.min",jquery:"jquery-3.2.1",swiper:"swiper.min"}}),define(["common","jquery","swiper"],function(e,C,i){e.init();var H={s:["","\u680b","\u95f4","\u5957","\u4eba"],env:"dev",server:{dev:"//dev.xiangdao.info",pro:"//www.xiangdao.info"},videoIndexArr:[]};H.id=e.parseQueryString().houseId;var R=new i(".swiper-container-bed",{slidesPerView:"auto",spaceBetween:30,init:!1});H.q=function(e){return document.querySelector(e)},H.judgeHeight=function(e){var i=e.clientHeight;e.style.height="auto",e.style.display="block",e.clientHeight<=i?e.nextElementSibling.style.display="none":e.removeAttribute("style")};var a=H.q(".swiper-pagination"),n=new i(".swiper-container-head",{pagination:{el:".swiper-pagination",type:"fraction"},on:{transitionEnd:function(){var i=this;0<H.videoIndexArr.length?H.videoIndexArr.forEach(function(e){e.index===i.activeIndex?a.classList.add("video"):a.classList.remove("video")}):a.classList.remove("video");var e=document.querySelectorAll("video");if(e&&0<e.length)for(var n=0;n<e.length;n++)e[n].pause()}}});e.request({url:H.server[H.env]+"/xiangdao-api/api/house/album_list/"+H.id,method:"GET",success:function(e){var i=e.json;if(i&&0<i.length){console.log(e);var t="";i.forEach(function(n,e){if(n.url){var i=n.url.split(",");0<i.length&&i.forEach(function(e,i){t+='<div class="swiper-slide">',1===n.type&&0===i?(t+='<video id="video'+n.id+'" class="head-video-li" preload="auto" controls  webkit-playsinline="true"\n playsinline="true"\n x5-playsinline="true"\n x5-video-player-type="h5"\n x5-video-player-fullscreen=""\n x5-video-orientation="portraint"\n x-webkit-airplay="true"\n controlsList="nodownload" controls="controls" src="'+e+'" poster="'+e+'?vframe/jpg/offset/2/w/640/h/360" />',H.videoIndexArr.push({index:i,item:e})):t+='<img class="head-img-li" src="'+e+'" alt />',t+="</div>"})}0===e&&1===n.type&&a.classList.add("video")}),H.q("#headImgs").innerHTML=t,n.update()}}}),e.request({url:H.server[H.env]+"/xiangdao-api/api/house/details/"+H.id,method:"GET",success:function(e){console.log(e);var a=e.json,i=H.q(".hc-ver"),n=H.q(".hc-user"),t=H.q("#houseNo"),s=H.q("#profileStr"),l=H.q(".hc-tit"),r=H.q("#baseIndoorArea"),o=H.q("#baseOrientation"),d=H.q("#baseEstablishDate"),c=H.q("#profileRentMode"),v=H.q("#profileRentMode2"),p=H.q("#baseCourtyardArea"),u=(H.q("#ownerAvatar2"),H.q("#ownerNickName"),H.q("#ownerHouseIsAuthentication2"),H.q("#baseOwnerBrief"),H.q("#ruleYearMoney")),h=H.q("#baseLiveNumber"),f=H.q("#floor"),m=H.q("#infoBrief"),g=H.q("#otherDesc"),y=H.q("#mpConfirm"),b=H.q(".nearby"),q=[null,"\u5c42","\u5367","\u6d74","\u53a8","\u536b","\u5ba2\u5385","\u9910\u5385","\u4e66\u623f","\u9633\u53f0"],x=[{id:1,name:"\u5927\u5e8a",icon:"icon_bed.png",bed:[],list:[null,"2*1.8m","2*1.5m","1.8*1.5m","2*2m","2*1.6m","2.2*2.2m"]},{id:2,name:"\u5355\u4eba\u5e8a",icon:"icon_sbed.png",bed:[],list:[null,"2*1m","2*1.2m","1.9*2m","2*0.8m","2*1.35m","2*1.1m","2*1.3m"]},{id:3,name:"\u53cc\u5c42\u5e8a",icon:"icon_dbed.png",bed:[],list:[null,"0.9*1.9m\u4e0a\uff0c1.2*1.9m\u4e0b","1.2*1.9m\u4e0a\uff0c1.5*1.9m\u4e0b","1.35*1.9m\u4e0a\uff0c1.5*1.9m\u4e0b","0.9*1.8m","1*1.9m","1.2*1.9m","1.8*1.2m"]},{id:4,name:"\u6c99\u53d1\u5e8a",icon:"icon_sofa.png",bed:[],list:[null,"2*1.2m","2*1.5m"]},{id:5,name:"\u5706\u5e8a",icon:"icon_cbed.png",bed:[],list:[null,"\u76f4\u5f842m","\u76f4\u5f842.2m"]}],T=[null,"\u9760\u8fd1\u5c0f\u533a\u5185\u4e3b\u8def","\u9760\u8fd1\u4e3b\u8def","\u9760\u8fd1\u505c\u8f66\u573a","\u9760\u8fd1\u516c\u56ed\u6216\u5e7f\u573a","\u9760\u8fd1\u591c\u5e02","\u5468\u8fb9\u8f83\u5b89\u9759","\u5468\u8fb9\u5f88\u5b89\u9759","\u9760\u8fd1\u98de\u673a\u573a","\u9760\u8fd1\u5c0f\u533a\u51fa\u5165\u53e3"],w=[null,"\u5c0f\u533a\u5185\u90e8","\u53ef\u89c1\u82b1\u56ed","\u53ef\u89c1\u5c71\u666f","\u53ef\u89c1\u6e56\u666f","\u53ef\u89c1\u6c5f\u666f","\u53ef\u89c1\u6d77\u666f","\u53ef\u89c1\u6811\u6797","\u53ef\u89c1\u8857\u666f","\u53ef\u89c1\u6e38\u6cf3\u6c60","\u53ef\u89c1\u9ad8\u5c14\u592b\u7403\u573a"];if(a.baseBedType){var E=a.baseBedType.split(",");E&&0<E.length&&E.forEach(function(e){var i=e.split("-");x.forEach(function(e){parseInt(i[0])===e.id&&e.bed.push(i)})})}if(a.baseIndoorScenery){var A="";a.baseIndoorScenery.split(",").forEach(function(e){A+='<div class="hci-label">'+w[parseInt(e)]+"</div>"}),C("#baseScenery").html(A)}else C("#baseIndoorScenery").hide();if(a.baseNoise){var I="";a.baseNoise.split(",").forEach(function(e){I+='<div class="hci-label">'+T[parseInt(e)]+"</div>"}),C("#baseNoise").html(I)}else C("#baseNoiseWrap").hide();b.addEventListener("click",function(){location.href="video.html?id="+a.villageId},!1),C.ajax({url:H.server[H.env]+"/xiangdao-api/api/house/house_list",method:"POST",dataType:"json",headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify({villageId:a.villageId}),success:function(e){if(console.log(e),0===e.status){var i=e.json.result;if(i&&0<i.length){var n="";i.forEach(function(e){n+='<div class="hli" data-id="'+e.houseId+'">\n                <img class="hli-img" src="'+e.infoCover+'" alt />\n                <div class="hli-stit">'+e.profileStr+'</div>\n                <div class="hli-tit">'+e.infoTitle+'</div>\n                <div class="hli-price">\uffe5<span>'+e.ruleMonthMoney+"</span>"+(e.profileRentMode?"/"+H.s[e.profileRentMode]:"")+"/\u6708</div>\n            </div>"}),H.q("#hlist").innerHTML=n,C(".hli").on("click",function(){var e=C(this).data("id");location.href="house_details.html?houseId="+e})}var t=document.querySelectorAll(".link");if(t&&0<t.length)for(var a=0;a<t.length;a++)t[a].addEventListener("click",function(){openApp()},!1)}}});var N=H.q("#hcInfo2");x.forEach(function(i){var n="";if(0<i.bed.length){var t=0;i.bed.forEach(function(e){t+=parseInt(e[2])}),n+='<div class="hci-tli">\n',n+='<img class="hci-icon" src="img/'+i.icon+'" alt />',n+='<div class="hci-text">'+t+"\u5f20"+i.name+"</div></div>",n+='<div class="hci-trli">',i.bed.forEach(function(e){n+='<div class="hci-trli-row"><span>('+i.list[e[1]]+")</span>&times;"+e[2]+"</div>"}),n+="</div></div>\n";var e=document.createElement("div");e.classList.add("hci-tli-wrap"),e.classList.add("swiper-slide"),e.innerHTML=n,N.appendChild(e),R.update(),R.init()}});var S=a.baseHouseType.split(",");if(S&&0<S.length){var L="";S.forEach(function(e,i){var n=e.split("-");0<n[1]&&(L+=n[1]+q[parseInt(n[0])],i+1<S.length&&(L+="/")),"2"===n[0]&&(H.q("#roomCount").innerText=n[1]),"1"===n[0]&&(f.innerText=n[1]),0===i&&n[2]&&(f.innerText=n[1]+"~"+n[2])}),H.q("#baseHouseType").innerText=L}i.style.display="flex",i.innerText="\u623f\u6e90\u5df2\u8ba4\u8bc1",i.classList.add("verified"),n.src=a.ownerAvatar,t.innerText=a.houseNo,s.innerText=a.profileStr,l.innerText=a.infoTitle,r.innerText=a.baseIndoorArea,o.innerText=a.baseOrientation,d.innerText=new Date(a.baseEstablishDate).getFullYear(),c.innerText=[null,"\u6574\u680b\u51fa\u79df","\u72ec\u7acb\u51fa\u79df","\u6574\u5957\u51fa\u79df"][a.profileRentMode],v.innerText=a.profileRentMode?"/"+H.s[a.profileRentMode]:"",u.innerText=a.ruleMonthMoney,m.innerText=a.infoBrief,H.judgeHeight(m),h.innerText=a.baseLiveNumber,a.ruleOtherMoneyDesc&&"undefined"!==a.ruleOtherMoneyDesc&&(g.innerText=a.ruleOtherMoneyDesc),phone.setAttribute("href","tel:"+a.rulePhone),y.addEventListener("click",function(){this.parentNode.parentNode.style.display="none"},!1);var j=H.q(".rule-other"),k=H.q(".rule-pet"),M=H.q(".rule-party");a.ruleRequireJson?(j.innerText=a.ruleRequireJson,j.style.display="flex"):j.style.display="none",k.innerText=0===a.ruleIsAllowPet?"\u4e0d\u5141\u8bb8\u5e26\u5ba0\u7269":"\u5141\u8bb8\u5e26\u5ba0\u7269",M.innerText=0===a.ruleIsAllowParty?"\u4e0d\u5141\u8bb8\u4e3e\u529e\u6d3b\u52a8\u6216\u805a\u4f1a":"\u5141\u8bb8\u4e3e\u529e\u6d3b\u52a8\u6216\u805a\u4f1a",C.ajax({url:H.server[H.env]+"/xiangdao-api/api/house/faq_list",method:"POST",dataType:"json",async:!1,headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify({houseId:H.id,pageNo:1,pageSize:6}),success:function(e){console.log(e);var i=e.json.result;2<e.json.totalCount&&(2<i.length&&(i.length=2),C("#askShowAll").show());var a="";i&&0<i.length&&(H.q(".ask-nodata").style.display="none",i.forEach(function(e){var i="";if(0<e.replyCount&&(i+='<div class="ali-reply">\n                    <div class="ali-rep-t">\n                        <img class="ali-rep-avatar" src="'+e.lastReplyAvatar+'" alt />\n                        <div class="ali-rep-name">'+e.lastReplyNickName+'</div>\n                    </div>\n                    <div class="ali-rep-tit">'+e.lastReplyTitle+"</div>\n                </div>\n",1<e.replyCount)){var n=e.avatarUrl.split(","),t="";n&&0<n.length&&(n.shift(),4<n.length&&(n.length=4),n.forEach(function(e){t+='<img class="alp-avatar" src="'+e+'" alt />'})),i+='<div class="ali-rep-more">\n                    <div class="alp-avatars">\n'+t+'                    </div>\n                    <div class="alp-txt">'+e.lastReplyNickName+"\u7b49"+(e.replyCount-1)+"\u4eba\u4e5f\u8fdb\u884c\u4e86\u56de\u7b54</div>\n                </div>"}a+='<div class="ask-li" data-id="'+e.faqId+'">\n                <div class="ali-t">\n                    <img class="ali-avatar" src="'+e.avatar+'" alt />\n                    <div class="ali-name">'+e.nickName+'</div>\n                </div>\n                <div class="ali-tit">'+e.title+"</div>\n"+i+"            </div>"}),C("#askList").html(a))}}),0<a.baseCourtyardArea?(p.innerText=a.baseCourtyardArea,p.parentNode.parentNode.style.display="flex"):p.parentNode.parentNode.style.display="none",C.ajax({url:H.server[H.env]+"/xiangdao-api/api/houseEditor/get_house_icon_group",success:function(e){console.log(e);var i=e.json;if(i&&0<i.length){var n="";n+='<div class="ist">\n',n+='<div class="ist-r">\n';var s=a.profileHouseIcon.split(",");i.forEach(function(a){var e="";a.list.forEach(function(n){var t=!1;s&&0<s.length&&s.forEach(function(e){var i=e.split("-");i[0]==a.type&&i[1]==n.iconSeq&&(t=!0)}),t&&(e+='<div class="ist-li '+(t?"sel":"")+'" data-id="'+n.iconSeq+'">'+n.iconName+"</div>")}),n+=e}),n+="</div>",n+="</div>";var t=H.q("#insWrap");t.innerHTML=n,H.judgeHeight(t)}}})}});var t=document.querySelectorAll(".pan-showall");if(t&&0<t.length)for(var s=0;s<t.length;s++)t[s].addEventListener("click",function(){var e=this.previousElementSibling;e&&e.classList.add("showAll"),this.style.display="none"},!1);var l=document.querySelectorAll(".pan-showall2");if(l&&0<l.length)for(var r=0;r<l.length;r++)l[r].addEventListener("click",function(){var e=this.previousElementSibling;"1"!==this.dataset.switch?(this.innerText="\u6536\u8d77 >>",this.dataset.switch="1",e&&e.classList.add("showAll")):(this.innerText="\u8be6\u60c5 >>",this.dataset.switch="0",e&&e.classList.remove("showAll"))},!1);var o=document.querySelectorAll(".link");if(o&&0<o.length)for(var d=0;d<o.length;d++)o[d].addEventListener("click",function(){openApp()},!1)});