require.config({paths:{common:"common.min",jquery:"jquery-3.2.1",swiper:"swiper.min"}}),define(["common","jquery","swiper"],function(e,M,i){e.init();var C={env:"dev",server:{dev:"//dev.xiangdao.info",pro:"//www.xiangdao.info"},videoIndexArr:[]};C.id=e.parseQueryString().houseId;var H=new i(".swiper-container-bed",{slidesPerView:"auto",spaceBetween:30,init:!1});C.q=function(e){return document.querySelector(e)},C.judgeHeight=function(e){var i=e.clientHeight;e.style.height="auto",e.style.display="block",e.clientHeight<=i?e.nextElementSibling.style.display="none":e.removeAttribute("style")};var t=C.q(".swiper-pagination"),n=new i(".swiper-container-head",{pagination:{el:".swiper-pagination",type:"fraction"},on:{transitionEnd:function(){var i=this;0<C.videoIndexArr.length?C.videoIndexArr.forEach(function(e){e.index===i.activeIndex?t.classList.add("video"):t.classList.remove("video")}):t.classList.remove("video");var e=document.querySelectorAll("video");if(e&&0<e.length)for(var n=0;n<e.length;n++)e[n].pause()}}});e.request({url:C.server[C.env]+"/xiangdao-api/api/house/album_list/"+C.id,method:"GET",success:function(e){var i=e.json;if(i&&0<i.length){console.log(e);var a="";i.forEach(function(n,e){if(n.url){var i=n.url.split(",");0<i.length&&i.forEach(function(e,i){a+='<div class="swiper-slide">',1===n.type&&0===i?(a+='<video id="video'+n.id+'" class="head-video-li" preload="auto" controls  webkit-playsinline="true"\n playsinline="true"\n x5-playsinline="true"\n x5-video-player-type="h5"\n x5-video-player-fullscreen=""\n x5-video-orientation="portraint"\n x-webkit-airplay="true"\n controls="controls" src="'+e+'" poster="'+e+'?vframe/jpg/offset/2/w/640/h/360" />',C.videoIndexArr.push({index:i,item:e})):a+='<img class="head-img-li" src="'+e+'" alt />',a+="</div>"})}0===e&&1===n.type&&t.classList.add("video")}),C.q("#headImgs").innerHTML=a,n.update()}}}),e.request({url:C.server[C.env]+"/xiangdao-api/api/house/details/"+C.id,method:"GET",success:function(e){console.log(e);var t=e.json,i=C.q(".hc-ver"),n=C.q(".hc-user"),a=C.q("#houseNo"),s=C.q("#profileStr"),l=C.q(".hc-tit"),r=C.q("#baseIndoorArea"),o=C.q("#baseOrientation"),d=C.q("#baseEstablishDate"),c=C.q("#profileRentMode"),v=C.q("#baseCourtyardArea"),p=(C.q("#ownerAvatar2"),C.q("#ownerNickName"),C.q("#ownerHouseIsAuthentication2"),C.q("#baseOwnerBrief"),C.q("#ruleYearMoney")),u=C.q("#baseLiveNumber"),h=C.q("#floor"),f=C.q("#infoBrief"),m=C.q("#otherDesc"),g=C.q("#mpConfirm"),y=C.q(".nearby"),b=[null,"\u5c42","\u5367","\u6d74","\u53a8","\u536b","\u5ba2\u5385","\u9910\u5385","\u4e66\u623f","\u9633\u53f0"],q=[{id:1,name:"\u5927\u5e8a",icon:"icon_bed.png",bed:[],list:[null,"2*1.8m","2*1.5m","1.8*1.5m","2*2m","2*1.6m","2.2*2.2m"]},{id:2,name:"\u5355\u4eba\u5e8a",icon:"icon_sbed.png",bed:[],list:[null,"2*1m","2*1.2m","1.9*2m","2*0.8m","2*1.35m","2*1.1m","2*1.3m"]},{id:3,name:"\u53cc\u5c42\u5e8a",icon:"icon_dbed.png",bed:[],list:[null,"0.9*1.9m\u4e0a\uff0c1.2*1.9m\u4e0b","1.2*1.9m\u4e0a\uff0c1.5*1.9m\u4e0b","1.35*1.9m\u4e0a\uff0c1.5*1.9m\u4e0b","0.9*1.8m","1*1.9m","1.2*1.9m","1.8*1.2m"]},{id:4,name:"\u6c99\u53d1\u5e8a",icon:"icon_sofa.png",bed:[],list:[null,"2*1.2m","2*1.5m"]},{id:5,name:"\u5706\u5e8a",icon:"icon_cbed.png",bed:[],list:[null,"\u76f4\u5f842m","\u76f4\u5f842.2m"]}],x=[null,"\u9760\u8fd1\u5c0f\u533a\u5185\u4e3b\u8def","\u9760\u8fd1\u4e3b\u8def","\u9760\u8fd1\u505c\u8f66\u573a","\u9760\u8fd1\u516c\u56ed\u6216\u5e7f\u573a","\u9760\u8fd1\u591c\u5e02","\u5468\u8fb9\u8f83\u5b89\u9759","\u5468\u8fb9\u5f88\u5b89\u9759","\u9760\u8fd1\u98de\u673a\u573a","\u9760\u8fd1\u5c0f\u533a\u51fa\u5165\u53e3"],T=[null,"\u5c0f\u533a\u5185\u90e8","\u53ef\u89c1\u82b1\u56ed","\u53ef\u89c1\u5c71\u666f","\u53ef\u89c1\u6e56\u666f","\u53ef\u89c1\u6c5f\u666f","\u53ef\u89c1\u6d77\u666f","\u53ef\u89c1\u6811\u6797","\u53ef\u89c1\u8857\u666f","\u53ef\u89c1\u6e38\u6cf3\u6c60","\u53ef\u89c1\u9ad8\u5c14\u592b\u7403\u573a"];if(t.baseBedType){var w=t.baseBedType.split(",");w&&0<w.length&&w.forEach(function(e){var i=e.split("-");q.forEach(function(e){parseInt(i[0])===e.id&&e.bed.push(i)})})}if(t.baseIndoorScenery){var E="";t.baseIndoorScenery.split(",").forEach(function(e){E+='<div class="hci-label">'+T[parseInt(e)]+"</div>"}),M("#baseScenery").html(E)}else M("#baseIndoorScenery").hide();if(t.baseNoise){var A="";t.baseNoise.split(",").forEach(function(e){A+='<div class="hci-label">'+x[parseInt(e)]+"</div>"}),M("#baseNoise").html(A)}else M("#baseNoiseWrap").hide();y.addEventListener("click",function(){location.href="video.html?id="+t.villageId},!1),M.ajax({url:C.server[C.env]+"/xiangdao-api/api/house/house_list",method:"POST",dataType:"json",headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify({villageId:t.villageId}),success:function(e){if(console.log(e),0===e.status){var i=e.json.result;if(i&&0<i.length){var n="";i.forEach(function(e){n+='<div class="hli" data-id="'+e.houseId+'">\n                <img class="hli-img" src="'+e.infoCover+'" alt />\n                <div class="hli-stit">'+e.profileStr+'</div>\n                <div class="hli-tit">'+e.infoTitle+'</div>\n                <div class="hli-price">\uffe5<span>'+e.ruleMonthMoney+"</span>/\u6708</div>\n            </div>"}),C.q("#hlist").innerHTML=n,M(".hli").on("click",function(){var e=M(this).data("id");location.href="house_details.html?houseId="+e})}var a=document.querySelectorAll(".link");if(a&&0<a.length)for(var t=0;t<a.length;t++)a[t].addEventListener("click",function(){openApp()},!1)}}});var I=C.q("#hcInfo2");q.forEach(function(i){var n="";if(0<i.bed.length){n+='<div class="hci-tli">\n',n+='<img class="hci-icon" src="img/'+i.icon+'" alt />',n+='<div class="hci-text">'+i.bed[0][2]+"\u5f20"+i.name+"</div></div>",n+='<div class="hci-trli">',i.bed.forEach(function(e){n+='<div class="hci-trli-row"><span>('+i.list[e[1]]+")</span>&times;"+e[2]+"</div>"}),n+="</div></div>\n";var e=document.createElement("div");e.classList.add("hci-tli-wrap"),e.classList.add("swiper-slide"),e.innerHTML=n,I.appendChild(e),H.update(),H.init()}});var N=t.baseHouseType.split(",");if(N&&0<N.length){var S="";N.forEach(function(e,i){var n=e.split("-");0<n[1]&&(S+=n[1]+b[parseInt(n[0])],i+1<N.length&&(S+="/")),"2"===n[0]&&(C.q("#roomCount").innerText=n[1]),"1"===n[0]&&(h.innerText=n[1]),0===i&&n[2]&&(h.innerText=n[1]+"~"+n[2])}),C.q("#baseHouseType").innerText=S}i.style.display="flex",i.innerText="\u623f\u6e90\u5df2\u8ba4\u8bc1",i.classList.add("verified"),n.src=t.ownerAvatar,a.innerText=t.houseNo,s.innerText=t.profileStr,l.innerText=t.infoTitle,r.innerText=t.baseIndoorArea,o.innerText=t.baseOrientation,d.innerText=new Date(t.baseEstablishDate).getFullYear(),c.innerText=[null,"\u6574\u680b\u51fa\u79df","\u72ec\u7acb\u51fa\u79df","\u6574\u5957\u51fa\u79df"][t.profileRentMode],p.innerText=t.ruleMonthMoney,f.innerText=t.infoBrief,C.judgeHeight(f),u.innerText=t.baseLiveNumber,t.ruleOtherMoneyDesc&&"undefined"!==t.ruleOtherMoneyDesc&&(m.innerText=t.ruleOtherMoneyDesc),phone.setAttribute("href","tel:"+t.rulePhone),g.addEventListener("click",function(){this.parentNode.parentNode.style.display="none"},!1);var L=C.q(".rule-other"),j=C.q(".rule-pet"),k=C.q(".rule-party");t.ruleRequireJson?(L.innerText=t.ruleRequireJson,L.style.display="flex"):L.style.display="none",j.innerText=0===t.ruleIsAllowPet?"\u4e0d\u5141\u8bb8\u5e26\u5ba0\u7269":"\u5141\u8bb8\u5e26\u5ba0\u7269",k.innerText=0===t.ruleIsAllowParty?"\u4e0d\u5141\u8bb8\u4e3e\u529e\u6d3b\u52a8\u6216\u805a\u4f1a":"\u5141\u8bb8\u4e3e\u529e\u6d3b\u52a8\u6216\u805a\u4f1a",M.ajax({url:C.server[C.env]+"/xiangdao-api/api/house/faq_list",method:"POST",dataType:"json",async:!1,headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify({houseId:C.id,pageNo:1,pageSize:6}),success:function(e){console.log(e);var i=e.json.result;2<e.json.totalCount&&(2<i.length&&(i.length=2),M("#askShowAll").show());var t="";i&&0<i.length&&(C.q(".ask-nodata").style.display="none",i.forEach(function(e){var i="";if(0<e.replyCount&&(i+='<div class="ali-reply">\n                    <div class="ali-rep-t">\n                        <img class="ali-rep-avatar" src="'+e.lastReplyAvatar+'" alt />\n                        <div class="ali-rep-name">'+e.lastReplyNickName+'</div>\n                    </div>\n                    <div class="ali-rep-tit">'+e.lastReplyTitle+"</div>\n                </div>\n",1<e.replyCount)){var n=e.avatarUrl.split(","),a="";n&&0<n.length&&(n.shift(),4<n.length&&(n.length=4),n.forEach(function(e){a+='<img class="alp-avatar" src="'+e+'" alt />'})),i+='<div class="ali-rep-more">\n                    <div class="alp-avatars">\n'+a+'                    </div>\n                    <div class="alp-txt">'+e.lastReplyNickName+"\u7b49"+(e.replyCount-1)+"\u4eba\u4e5f\u8fdb\u884c\u4e86\u56de\u7b54</div>\n                </div>"}t+='<div class="ask-li" data-id="'+e.faqId+'">\n                <div class="ali-t">\n                    <img class="ali-avatar" src="'+e.avatar+'" alt />\n                    <div class="ali-name">'+e.nickName+'</div>\n                </div>\n                <div class="ali-tit">'+e.title+"</div>\n"+i+"            </div>"}),M("#askList").html(t))}}),0<t.baseCourtyardArea?(v.innerText=t.baseCourtyardArea,v.parentNode.parentNode.style.display="flex"):v.parentNode.parentNode.style.display="none",M.ajax({url:C.server[C.env]+"/xiangdao-api/api/houseEditor/get_house_icon_group",success:function(e){console.log(e);var i=e.json;if(i&&0<i.length){var n="";n+='<div class="ist">\n',n+='<div class="ist-r">\n';var s=t.profileHouseIcon.split(",");i.forEach(function(t){var e="";t.list.forEach(function(n){var a=!1;s&&0<s.length&&s.forEach(function(e){var i=e.split("-");i[0]==t.type&&i[1]==n.iconSeq&&(a=!0)}),a&&(e+='<div class="ist-li '+(a?"sel":"")+'" data-id="'+n.iconSeq+'">'+n.iconName+"</div>")}),n+=e}),n+="</div>",n+="</div>";var a=C.q("#insWrap");a.innerHTML=n,C.judgeHeight(a)}}})}});var a=document.querySelectorAll(".pan-showall");if(a&&0<a.length)for(var s=0;s<a.length;s++)a[s].addEventListener("click",function(){var e=this.previousElementSibling;e&&e.classList.add("showAll"),this.style.display="none"},!1);var l=document.querySelectorAll(".pan-showall2");if(l&&0<l.length)for(var r=0;r<l.length;r++)l[r].addEventListener("click",function(){var e=this.previousElementSibling;"1"!==this.dataset.switch?(this.innerText="\u6536\u8d77 >>",this.dataset.switch="1",e&&e.classList.add("showAll")):(this.innerText="\u8be6\u60c5 >>",this.dataset.switch="0",e&&e.classList.remove("showAll"))},!1);var o=document.querySelectorAll(".link");if(o&&0<o.length)for(var d=0;d<o.length;d++)o[d].addEventListener("click",function(){openApp()},!1)});