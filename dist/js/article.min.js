require.config({paths:{common:"common.min",jquery:"jquery-3.2.1"}}),define(["common","jquery"],function(i,r){var o={env:"dev",server:{dev:"//dev.xiangdao.info",pro:"//www.xiangdao.info"},parseDate:function(i){i=new Date(i);return i.getFullYear()+"\u5e74"+(i.getMonth()+1)+"\u6708"+i.getDate()+"\u65e5"},parseDateComment:function(i){i=new Date(i);return(i.getMonth()+1<10?"0"+(i.getMonth()+1):i.getMonth()+1)+"-"+(i.getDate()<10?"0"+i.getDate():i.getDate())+" "+(i.getHours()<10?"0"+i.getHours():i.getHours())+":"+(i.getMinutes()<10?"0"+i.getMinutes():i.getMinutes())},q:function(i){return document.querySelector(i)}};o.id=i.parseQueryString().id,i.init(),i.request({url:o.server[o.env]+"/xiangdao-api/api/news/article_details/"+o.id,method:"GET",success:function(i){console.log(i);var n=i.json,e=o.q(".header-img"),s=o.q(".articleTitle"),t=o.q(".articleTime"),l=o.q(".viewNum"),a=o.q("#articleContent"),c=o.q(".icon-praise"),i=o.q(".pr-txt span");e.src=n.detailsCover,s.innerText=n.title,n.publishDate&&(t.innerText="\u53d1\u5e03\u4e8e"+o.parseDate(n.publishDate)),n.lookNumber&&(l.innerText=n.lookNumber+"\u6b21\u89c2\u770b"),n.publishDate&&n.lookNumber&&(t.innerText+=" | "),a.innerHTML=n.content,i.innerText=n.likeCount,n.isLike?c.src="img/praised.png":c.src="img/praise.png",r.ajax({url:o.server[o.env]+"/xiangdao-api/api/news/article/"+o.id+"/house_list",method:"GET",dataType:"json",success:function(i){var n;console.log(i),0===i.status&&((i=i.json)&&0<i.length?(n="",i.forEach(function(i){n+='<div class="vp-li" data-id="'+i.houseId+'">\n                <img class="vp-l" src="'+i.infoCover+'" alt />\n                <div class="vp-r">\n                    <div class="vp-st">'+i.profileStr+'</div>\n                    <div class="vp-ti">'+i.infoTitle+'</div>\n                    <div class="vp-price"><span>\uffe5<i>'+i.ruleMonthMoney+"</i></span>/\u6708</div>\n                </div>\n            </div>"}),o.q(".vp-list").innerHTML=n,1===i.length?(o.q(".vp-list").style.height="2.32rem",o.q(".show-all").style.display="none"):(2===i.length&&(o.q(".show-all").style.display="none"),o.q(".vp-list").style.height="5.6rem"),r(".vp-li").on("click",function(){var i=r(this).data("id");location.href="house_details.html?houseId="+i})):o.q(".vp-wrap").style.display="none")}}),r.ajax({url:o.server[o.env]+"/xiangdao-api/api/news/comment_list",method:"POST",dataType:"json",headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify({bizId:o.id,bizType:2,pageNo:1}),success:function(i){var n=i.json.result,l="";n&&0<n.length?(o.q("#commentCount").innerText=" \xb7 "+i.json.totalCount,n.forEach(function(i){var n,e="",s="",t="";i.images&&(e+='<div class="cli-imgs">\n',(n=i.images.split(","))&&0<n.length&&n.forEach(function(i){e+='<img class="cli-img" src="'+i+'" alt />'}),e+="</div>\n"),i.list&&0<i.list.length&&(s+='<div class="cli-reply">\n',i.list.forEach(function(i){s+='                        <div class="clr-li">\n                            <img class="clr-l" src="'+i.avatar+'" alt />\n                            <div class="clr-r">\n                                <div class="clr-name">'+i.nickName+'</div>\n                                <div class="clr-cont">'+(i.parentNickName?"\u56de\u590d"+i.parentNickName+": ":"")+i.content+'</div>\n                                <div class="clr-fun">\n                                    <div class="clr-fl">'+o.parseDateComment(i.createDate)+'</div>\n                                    <div class="clr-fr">\n                                        <div class="clrr-li link">\n                                            <img class="clrr-icon" src="img/icon_reply.png" alt />\n                                            <div class="clrr-text">\u56de\u590d</div>\n                                        </div>\n                                        <div class="clrr-li link">\n                                            <img class="clrr-icon" src="img/praise.png" alt />\n                                            <div class="clrr-text">'+(i.isLike?"\u5df2\u70b9\u8d5e":"\u70b9\u8d5e")+"</div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n"}),s+="                    </div>"),t+='<div class="cli-fun">\n                        <div class="cf-l">'+o.parseDateComment(i.createDate)+'</div>\n                        <div class="cf-r">\n                            <div class="cf-ri link">\n                                <img class="cfr-icon" src="img/icon_reply.png" alt />\n                                <div class="cfr-text">'+(i.childCommentCount||"\u56de\u590d")+'</div>\n                            </div>\n                            <div class="cf-ri link">\n                                <img class="cfr-icon" src="img/praise.png" alt />\n                                <div class="cfr-text">'+(i.likeCount||"\u70b9\u8d5e")+"</div>\n                            </div>\n                        </div>\n                    </div>",l+='<div class="cli">\n                <img class="cli-l" src="'+i.avatar+'" alt />\n                <div class="cli-r">\n                    <div class="cli-name">'+i.nickName+'<img class="cli-report link" src="img/icon_alarm.png" alt /></div>\n                    <div class="cli-txt">'+i.content+"</div>\n"+e+s+t+"                </div>\n            </div>"})):l+='<div class="comment-nodata"><img class="comment-nodata-icon" src="img/comment_nodata.png" alt /><div class="comment-nodata-tit">\u6682\u65e0\u6d88\u606f</div><div class="comment-nodata-stit">\u6682\u65f6\u8fd8\u6ca1\u6536\u5230\u4efb\u4f55\u6d88\u606f</div></div>',o.q(".com-list").innerHTML=l;var e=document.querySelectorAll(".link");if(e&&0<e.length)for(var s=0;s<e.length;s++)e[s].addEventListener("click",function(){openApp()},!1)}})}});var n=document.querySelectorAll(".pan-showall");if(n&&0<n.length)for(var e=0;e<n.length;e++)n[e].addEventListener("click",function(){var i=this.previousElementSibling;i&&i.classList.add("showAll"),this.style.display="none"},!1);r(".show-all").on("click",function(){var i=r(this);i.hasClass("cols")?(i.removeClass("cols").find("span").text("\u6536\u8d77"),i.prev(".vp-list").addClass("showAll")):(i.addClass("cols").find("span").text("\u5c55\u5f00"),i.prev(".vp-list").removeClass("showAll"))});var s=document.querySelectorAll(".link");if(s&&0<s.length)for(var t=0;t<s.length;t++)s[t].addEventListener("click",function(){openApp()},!1)});