require.config({paths:{common:"common.min",jquery:"jquery-3.2.1",swiper:"swiper.min"}}),define(["common","jquery","swiper"],function(e,_,i){e.init();var H={s:["","\u680b","\u95f4","\u5957","\u4eba"],env:"dev",server:{dev:"//dev.xiangdao.info",pro:"//www.xiangdao.info"},videoIndexArr:[]};H.id=e.parseQueryString().id;var D=new i(".swiper-container-bed",{slidesPerView:"auto",spaceBetween:30,init:!1});function q(e){return document.querySelector(e)}function M(e){if(e){e=new Date(e);return e.getFullYear().toString().substring(2)+"\u5e74"+(e.getMonth()+1)+"\u6708"+e.getDate()+"\u65e5"}return""}var j=q(".swiper-pagination"),B=new i(".swiper-container-head",{pagination:{el:".swiper-pagination",type:"fraction"},on:{transitionEnd:function(){var i=this;0<H.videoIndexArr.length?H.videoIndexArr.forEach(function(e){e.index===i.activeIndex?j.classList.add("video"):j.classList.remove("video")}):j.classList.remove("video");var e=document.querySelectorAll("video");if(e&&0<e.length)for(var n=0;n<e.length;n++)e[n].pause()}}});_.ajax({url:H.server[H.env]+"/xiangdao-api/api/house/details/"+H.id,method:"POST",dataType:"json",headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify({houseId:H.id}),success:function(e){console.log(e);var t,i,n,s,a,o,l=e.json,c=q(".hc-ver"),r=q(".hc-user"),d=(q("#houseNo"),q("#profileStr")),m=q(".hc-tit"),p=q("#baseIndoorArea"),v=q("#baseOrientation"),u=q("#baseDecorationDate"),h=q("#ruleRentType"),g=q("#baseCourtyardArea"),f=(q("#ruleYearMoney"),q("#baseLiveNumber")),y=(q("#floor"),q("#infoBrief")),b=q("#otherDesc"),e=q("#mpConfirm"),T=[{id:1,name:"\u5927\u5e8a",icon:"icon_bed.png",bed:[],list:[null,"2*1.8m","2*1.5m","1.8*1.5m","2*2m","2*1.6m","2.2*2.2m"]},{id:2,name:"\u5355\u4eba\u5e8a",icon:"icon_sbed.png",bed:[],list:[null,"2*1m","2*1.2m","1.9*2m","2*0.8m","2*1.35m","2*1.1m","2*1.3m"]},{id:3,name:"\u53cc\u5c42\u5e8a",icon:"icon_dbed.png",bed:[],list:[null,"0.9*1.9m\u4e0a\uff0c1.2*1.9m\u4e0b","1.2*1.9m\u4e0a\uff0c1.5*1.9m\u4e0b","1.35*1.9m\u4e0a\uff0c1.5*1.9m\u4e0b","0.9*1.8m","1*1.9m","1.2*1.9m","1.8*1.2m"]},{id:4,name:"\u6c99\u53d1\u5e8a",icon:"icon_sofa.png",bed:[],list:[null,"2*1.2m","2*1.5m"]},{id:5,name:"\u5706\u5e8a",icon:"icon_cbed.png",bed:[],list:[null,"\u76f4\u5f842m","\u76f4\u5f842.2m"]}],L=[null,"\u9760\u8fd1\u5c0f\u533a\u5185\u4e3b\u8def","\u9760\u8fd1\u4e3b\u9053","\u9760\u8fd1\u505c\u8f66\u573a","\u9760\u8fd1\u516c\u56ed\u6216\u5e7f\u573a","\u9760\u8fd1\u591c\u5e02","\u5468\u8fb9\u8f83\u5b89\u9759","\u5468\u8fb9\u5f88\u5b89\u9759","\u9760\u8fd1\u98de\u673a\u573a","\u9760\u8fd1\u5c0f\u533a\u51fa\u5165\u53e3"],w=[null,"\u5c0f\u533a\u5185\u90e8","\u53ef\u89c1\u82b1\u56ed","\u53ef\u89c1\u5c71\u666f","\u53ef\u89c1\u6e56\u666f","\u53ef\u89c1\u6c5f\u666f","\u53ef\u89c1\u6d77\u666f","\u53ef\u89c1\u6811\u6797","\u53ef\u89c1\u8857\u666f","\u53ef\u89c1\u6e38\u6cf3\u6c60","\u53ef\u89c1\u9ad8\u5c14\u592b\u7403\u573a"];l.albumList&&0<l.albumList.length&&((i=l.albumList)&&0<i.length&&(t="",i.forEach(function(n,e){var i;!n.url||0<(i=n.url.split(",")).length&&i.forEach(function(e,i){t+='<div class="swiper-slide">',1===n.type&&0===i?(t+='<video id="video'+n.id+'" class="head-video-li" preload="auto" controls  webkit-playsinline="true"\n playsinline="true"\n x5-playsinline="true"\n x5-video-player-type="h5"\n x5-video-player-fullscreen=""\n x5-video-orientation="portraint"\n x-webkit-airplay="true"\n controlsList="nodownload" controls="controls" src="'+e+'" poster="'+e+'?vframe/jpg/offset/2/w/640/h/360" />',H.videoIndexArr.push({index:i,item:e})):t+='<img class="head-img-li" src="'+e+'" alt />',t+="</div>"}),0===e&&1===n.type&&j.classList.add("video")}),q("#headImgs").innerHTML=t,B.update())),!l.houseTagName||(i=l.houseTagName.split(","))&&0<i.length&&(s=n="",i.forEach(function(e,i){i<4?n+='<div class="hc-tag">'+e+"</div>":q(".hc-tag-more").style.display="block",s+='<div class="top-tag-pop">'+e+"</div>"}),q(".hc-tags-l").innerHTML=n,q("#allTag").innerHTML=s,q(".hc-tags").addEventListener("click",function(){var e,i,n;q(".pe").style.display="flex",e=document.documentElement.scrollTop||document.body.scrollTop,i=document.body,(n=i.style).position="fixed",n.top=-e+"px",n.left="0",n.right="0",n.bottom="0",i.dataset.st=e.toString()},!1),q(".pe-close").addEventListener("click",function(){var e;q(".pe").style.display="none",document.body.style.position="static",window.scroll(0,e||document.body.dataset.st)},!1)),!l.baseBedType||(k=l.baseBedType.split(","))&&0<k.length&&k.forEach(function(e){var i=e.split("-");T.forEach(function(e){parseInt(i[0])===e.id&&e.bed.push(i)})}),l.baseIndoorScenery?(a="",l.baseIndoorScenery.split(",").forEach(function(e){a+='<div class="hci-label">'+w[parseInt(e)]+"</div>"}),_("#baseScenery").html(a)):_("#baseIndoorScenery").hide(),l.baseNoise?(o="",l.baseNoise.split(",").forEach(function(e){o+='<div class="hci-label">'+L[parseInt(e)]+"</div>"}),_("#baseNoise").html(o)):_("#baseNoiseWrap").hide();var x,k,E,C,I=q("#hcInfo2");T.forEach(function(i){var n,e,t="";0<i.bed.length&&(n=0,i.bed.forEach(function(e){n+=parseInt(e[2])}),t+='<div class="hci-tli">\n',t+='<img class="hci-icon" src="img/'+i.icon+'" alt />',t+='<div class="hci-text">'+n+"\u5f20"+i.name+"</div></div>",t+='<div class="hci-trli">',i.bed.forEach(function(e){t+='<div class="hci-trli-row"><span>('+i.list[e[1]]+")</span>&times;"+e[2]+"</div>"}),t+="</div></div>\n",(e=document.createElement("div")).classList.add("hci-tli-wrap"),e.classList.add("swiper-slide"),e.innerHTML=t,I.appendChild(e),D.update(),D.init())}),l.profileHouseTypeFloor&&(q("#floor").innerText=l.profileHouseTypeFloor.replace(/-/,"~")),l.profileHouseType&&(x=[null,"\u5ba4","\u53a8","\u536b","\u5385","\u5385","\u4e66\u623f","\u9633\u53f0"],k=l.profileHouseType.split(","),E=[],C="",k.forEach(function(e){var i=e.split("-"),e={};e.id=~~i[0],e.num=~~i[1],1===e.id&&(H.roomCount=e.num),E.push(e)}),E[3].num+=E[4].num,E.forEach(function(e,i){4!==i&&0<e.num&&(C+="/"+e.num+x[e.id])}),C=C.replace("/",""),q("#houseType").innerText=C),c.style.display="flex",c.innerText="\u623f\u6e90\u5df2\u8ba4\u8bc1",c.classList.add("verified"),r.src=l.ownerAvatar,d.innerText=l.profileStr,m.innerText=l.infoTitle,p.innerText=l.baseIndoorArea,v.innerText=l.baseOrientation,u.innerText=new Date(l.baseDecorationDate).getFullYear(),h.innerText=[null,"\u5e8a\u4f4d","\u72ec\u7acb\u623f\u95f4","\u6574\u5957\u51fa\u79df","\u6574\u680b\u51fa\u79df"][l.ruleRentType];h=q("#validDate");l.ruleValidBeginTime&&l.ruleValidEndTime&&h&&(h.innerText=M(l.ruleValidBeginTime)+"~"+M(l.ruleValidEndTime)),y.innerText=l.infoBrief,f.innerText=l.baseLiveNumber,l.ruleOtherMoneyDesc&&"undefined"!==l.ruleOtherMoneyDesc&&(b.innerText=l.ruleOtherMoneyDesc);b=q("#infoCover");b&&l.infoCover&&(b.src=l.infoCover);b=q("#infoTitle");b&&l.infoTitle&&(b.innerText=l.infoTitle),e.addEventListener("click",function(){this.parentNode.parentNode.style.display="none"},!1);e=l.aqList;2<l.aqCount&&(2<e.length&&(e.length=2),_("#askShowAll").show());var N,A,S="";e&&0<e.length&&(q(".ask-nodata").style.display="none",e.forEach(function(e){S+='<div class="ask-li">\n                                    <div class="ask-l">\u95ee</div>\n                                    <div class="ask-c">'+e.title+'</div>\n                                    <div class="ask-r">'+e.replyCount+"\u4e2a\u56de\u7b54</div>\n                                </div>"}),S+='<div class="btn-all">\u67e5\u770b\u5168\u90e8</div>',_("#askList").html(S)),0<l.baseCourtyardArea?(g.innerText=l.baseCourtyardArea,g.parentNode.parentNode.style.display="flex"):g.parentNode.parentNode.style.display="none",l.profileHouseIcon&&l.profileHouseIconList&&0<l.profileHouseIconList.length&&(N="",A=l.profileHouseIcon.split(","),l.profileHouseIconList.forEach(function(n){N+='<div class="pt-group">\n                                                    <div class="pt-tit"><img class="pt-yqss" src="'+n.typeUrl+'" alt />'+n.typeName+'</div>\n                                                    <div class="pt-con">',A.forEach(function(e){var i=e.split("-");~~i[0]!=~~n.type||(e=n.list)&&0<e.length&&e.forEach(function(e){~~i[1]==~~e.iconSeq&&(N+='<div class="pt-li">\n                                                                <img class="pt-img" src="'+e.iconUrl+'" alt/>\n                                                                <div class="pt-name">'+e.iconName+"</div>\n                                                            </div>")})}),N+="</div></div>"}),q("#insWrap").innerHTML=N),l.commentCount?(H.commentList=l.commentList,l.commentList.forEach(function(e){e.totalList=e.list}),H.renderCommentList()):(l="",l+='<div class="comment-nodata"><img class="comment-nodata-icon" src="img/comment_nodata.png" alt /><div class="comment-nodata-tit">\u6682\u65e0\u8bc4\u8bba</div><div class="comment-nodata-stit">\u8fd8\u6ca1\u6709\u623f\u5ba2\u5bf9\u8be5\u623f\u6e90\u53d1\u51fa\u8bc4\u8bba</div></div>',q("#commentList").innerHTML='<div class="comment-nodata"><img class="comment-nodata-icon" src="img/comment_nodata.png" alt /><div class="comment-nodata-tit">\u6682\u65e0\u8bc4\u8bba</div><div class="comment-nodata-stit">\u8fd8\u6ca1\u6709\u623f\u5ba2\u5bf9\u8be5\u623f\u6e90\u53d1\u51fa\u8bc4\u8bba</div></div>')}}),H.renderCommentList=function(){var a,e=H.commentList;e&&0<e.length&&(a="",e.forEach(function(e){if(a+='<div class="comment-li" data-id="'+e.commentId+'">\n<div class="comment-li-wrap">                        <img class="comment-l" src="'+e.avatar+'" alt />\n                        <div class="comment-c">\n                            <div class="comment-name">'+e.nickName+'</div>\n                            <div class="comment-con">'+(e.content||"")+"</div>\n",e.images){var i=e.images.split(",");if(i&&0<i.length){for(var n='<div class="comment-imgs">',t=0;t<i.length;t++)n+='<img class="comment-img swiper-lazy" data-index="'+t+'" data-img="'+e.images+'" src="'+i[t]+'" alt />';a+=n+="</div>"}}var s;a+='<div class="comment-fun">\n                <div class="comment-time">'+H.parseDateForComment(e.createTime)+' \xb7 </div>\n                <div class="comment-btn-reply link">\u56de\u590dTA</div>\n                <img class="comment-btn-more link" src="img/icon_more_s.png" alt />\n           </div>',a+='</div>\n           <div class="comment-r link">\n               <img class="comment-like-icon" src="img/icon_like_g.png" alt />\n               <div class="comment-like-num">'+(0<e.likeCount?e.likeCount:"")+"</div>\n           </div>\n       </div>",e.totalList&&0<e.totalList.length&&(s="",s+='<div class="comment-reply">',e.totalList.forEach(function(e){s+='<div class="cop-li" data-id="'+e.commentId+'">\n              <img class="cop-l" src="'+e.avatar+'" alt />\n              <div class="cop-c">\n                   <div class="cop-name">'+e.nickName+(1===e.isAuthor?'<span class="cop-author">\u4f5c\u8005</span>':"")+'</div>\n                   <div class="cop-con">\n                        '+(e.parentNickName?'\u56de\u590d<span class="link" style="color:#3397C6"> @'+e.parentNickName+"</span>\uff1a":"")+(e.content||"")+"\n",e.images&&(s+='<span class="cop-con-show-img swiper-lazy" data-index="0" data-img="'+e.images+'"><img class="cop-con-icon" src="img/icon_img_s.png" alt /><span>\u67e5\u770b\u56fe\u7247</span></span>\n'),s+='                   </div>\n                   <div class="cop-fun">\n                        <div class="cop-time">'+H.parseDateForComment(e.createTime)+' \xb7 </div>\n                        <div class="cop-btn-reply link">\u56de\u590dTA</div>\n                        <img class="cop-btn-more link" src="img/icon_more_s.png" alt />\n                   </div>\n              </div>\n<div class="cop-r link"><img class="cop-like-icon" src="img/icon_like_g.png" alt /><div class="cop-like-num">'+(0<e.likeCount?e.likeCount:"")+"</div></div>         </div>\n"}),a+=s+="</div>"),0<e.childCommentCount-e.totalList.length&&(a+='<div class="cop-more" data-page="1" data-switch="off" data-id="'+e.commentId+'"><span class="cop-more-text">\u70b9\u51fb\u5c55\u5f00'+(4<e.childCommentCount-e.totalList.length?5:e.childCommentCount-e.totalList.length)+'\u6761\u56de\u590d</span><img class="cop-more-btn" src="img/icon_arrow_g2.png" alt /></div>'),_("#commentList").html(a)}))};var n=document.querySelectorAll(".pan-showall");if(n&&0<n.length)for(var t=0;t<n.length;t++)n[t].addEventListener("click",function(){var e=this.previousElementSibling;e&&e.classList.add("showAll"),this.style.display="none"},!1);var s=document.querySelectorAll(".pan-showall2");if(s&&0<s.length)for(var a=0;a<s.length;a++)s[a].addEventListener("click",function(){var e=this.previousElementSibling;"1"!==this.dataset.switch?(this.innerText="\u6536\u8d77 >>",this.dataset.switch="1",e&&e.classList.add("showAll")):(this.innerText="\u8be6\u60c5 >>",this.dataset.switch="0",e&&e.classList.remove("showAll"))},!1);var o=document.querySelectorAll(".link");if(o&&0<o.length)for(var l=0;l<o.length;l++)o[l].addEventListener("click",function(){openApp()},!1)});