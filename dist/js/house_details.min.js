require.config({paths:{common:"common.min",jquery:"jquery-3.2.1",swiper:"swiper.min"}}),define(["common","jquery","swiper"],function(e,j,i){e.init();var k={s:["","\u680b","\u95f4","\u5957","\u4eba"],env:"dev",server:{dev:"//dev.xiangdao.info",pro:"//www.xiangdao.info"},videoIndexArr:[]};k.id=e.parseQueryString().houseId;var M=new i(".swiper-container-bed",{slidesPerView:"auto",spaceBetween:30,init:!1});k.q=function(e){return document.querySelector(e)},k.judgeHeight=function(e){var i=e.clientHeight;e.style.height="auto",e.style.display="block",e.clientHeight<=i?e.nextElementSibling.style.display="none":e.removeAttribute("style")};var H=k.q(".swiper-pagination"),C=new i(".swiper-container-head",{pagination:{el:".swiper-pagination",type:"fraction"},on:{transitionEnd:function(){var i=this;0<k.videoIndexArr.length?k.videoIndexArr.forEach(function(e){e.index===i.activeIndex?H.classList.add("video"):H.classList.remove("video")}):H.classList.remove("video");var e=document.querySelectorAll("video");if(e&&0<e.length)for(var n=0;n<e.length;n++)e[n].pause()}}});j.ajax({url:k.server[k.env]+"/xiangdao-api/api/house/details/"+k.id,method:"POST",success:function(e){console.log(e);var t,i,n,a,s=e.json,l=k.q(".hc-ver"),o=k.q(".hc-user"),r=k.q("#houseNo"),d=k.q("#profileStr"),c=k.q(".hc-tit"),p=k.q("#baseIndoorArea"),u=k.q("#baseOrientation"),h=k.q("#baseEstablishDate"),v=k.q("#profileRentMode"),f=k.q("#profileRentMode2"),m=k.q("#baseCourtyardArea"),g=(k.q("#ownerAvatar2"),k.q("#ownerNickName"),k.q("#ownerHouseIsAuthentication2"),k.q("#baseOwnerBrief"),k.q("#ruleYearMoney")),y=k.q("#baseLiveNumber"),b=k.q("#floor"),x=k.q("#infoBrief"),q=k.q("#otherDesc"),T=k.q("#mpConfirm"),e=k.q(".nearby"),w=[null,"\u5c42","\u5367","\u6d74","\u53a8","\u536b","\u5ba2\u5385","\u9910\u5385","\u4e66\u623f","\u9633\u53f0"],E=[{id:1,name:"\u5927\u5e8a",icon:"icon_bed.png",bed:[],list:[null,"2*1.8m","2*1.5m","1.8*1.5m","2*2m","2*1.6m","2.2*2.2m"]},{id:2,name:"\u5355\u4eba\u5e8a",icon:"icon_sbed.png",bed:[],list:[null,"2*1m","2*1.2m","1.9*2m","2*0.8m","2*1.35m","2*1.1m","2*1.3m"]},{id:3,name:"\u53cc\u5c42\u5e8a",icon:"icon_dbed.png",bed:[],list:[null,"0.9*1.9m\u4e0a\uff0c1.2*1.9m\u4e0b","1.2*1.9m\u4e0a\uff0c1.5*1.9m\u4e0b","1.35*1.9m\u4e0a\uff0c1.5*1.9m\u4e0b","0.9*1.8m","1*1.9m","1.2*1.9m","1.8*1.2m"]},{id:4,name:"\u6c99\u53d1\u5e8a",icon:"icon_sofa.png",bed:[],list:[null,"2*1.2m","2*1.5m"]},{id:5,name:"\u5706\u5e8a",icon:"icon_cbed.png",bed:[],list:[null,"\u76f4\u5f842m","\u76f4\u5f842.2m"]}],A=[null,"\u9760\u8fd1\u5c0f\u533a\u5185\u4e3b\u8def","\u9760\u8fd1\u4e3b\u8def","\u9760\u8fd1\u505c\u8f66\u573a","\u9760\u8fd1\u516c\u56ed\u6216\u5e7f\u573a","\u9760\u8fd1\u591c\u5e02","\u5468\u8fb9\u8f83\u5b89\u9759","\u5468\u8fb9\u5f88\u5b89\u9759","\u9760\u8fd1\u98de\u673a\u573a","\u9760\u8fd1\u5c0f\u533a\u51fa\u5165\u53e3"],I=[null,"\u5c0f\u533a\u5185\u90e8","\u53ef\u89c1\u82b1\u56ed","\u53ef\u89c1\u5c71\u666f","\u53ef\u89c1\u6e56\u666f","\u53ef\u89c1\u6c5f\u666f","\u53ef\u89c1\u6d77\u666f","\u53ef\u89c1\u6811\u6797","\u53ef\u89c1\u8857\u666f","\u53ef\u89c1\u6e38\u6cf3\u6c60","\u53ef\u89c1\u9ad8\u5c14\u592b\u7403\u573a"];s.albumList&&0<s.albumList.length&&((i=s.albumList)&&0<i.length&&(t="",i.forEach(function(n,e){var i;!n.url||0<(i=n.url.split(",")).length&&i.forEach(function(e,i){t+='<div class="swiper-slide">',1===n.type&&0===i?(t+='<video id="video'+n.id+'" class="head-video-li" preload="auto" controls  webkit-playsinline="true"\n playsinline="true"\n x5-playsinline="true"\n x5-video-player-type="h5"\n x5-video-player-fullscreen=""\n x5-video-orientation="portraint"\n x-webkit-airplay="true"\n controlsList="nodownload" controls="controls" src="'+e+'" poster="'+e+'?vframe/jpg/offset/2/w/640/h/360" />',k.videoIndexArr.push({index:i,item:e})):t+='<img class="head-img-li" src="'+e+'" alt />',t+="</div>"}),0===e&&1===n.type&&H.classList.add("video")}),k.q("#headImgs").innerHTML=t,C.update())),!s.baseBedType||(i=s.baseBedType.split(","))&&0<i.length&&i.forEach(function(e){var i=e.split("-");E.forEach(function(e){parseInt(i[0])===e.id&&e.bed.push(i)})}),s.baseIndoorScenery?(n="",s.baseIndoorScenery.split(",").forEach(function(e){n+='<div class="hci-label">'+I[parseInt(e)]+"</div>"}),j("#baseScenery").html(n)):j("#baseIndoorScenery").hide(),s.baseNoise?(a="",s.baseNoise.split(",").forEach(function(e){a+='<div class="hci-label">'+A[parseInt(e)]+"</div>"}),j("#baseNoise").html(a)):j("#baseNoiseWrap").hide(),e.addEventListener("click",function(){location.href="video.html?id="+s.villageId},!1),j.ajax({url:k.server[k.env]+"/xiangdao-api/api/house/house_list",method:"POST",dataType:"json",headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify({villageId:s.villageId}),success:function(e){if(console.log(e),0===e.status){var i,e=e.json.result;e&&0<e.length&&(i="",e.forEach(function(e){i+='<div class="hli" data-id="'+e.houseId+'">\n                <img class="hli-img" src="'+e.infoCover+'" alt />\n                <div class="hli-stit">'+e.profileStr+'</div>\n                <div class="hli-tit">'+e.infoTitle+'</div>\n                <div class="hli-price">\uffe5<span>'+e.ruleMonthMoney+"</span>"+(e.profileRentMode?"/"+k.s[e.profileRentMode]:"")+"/\u6708</div>\n            </div>"}),k.q("#hlist").innerHTML=i,j(".hli").on("click",function(){var e=j(this).data("id");location.href="house_details.html?houseId="+e}));var n=document.querySelectorAll(".link");if(n&&0<n.length)for(var t=0;t<n.length;t++)n[t].addEventListener("click",function(){openApp()},!1)}}});var L,S,N=k.q("#hcInfo2");E.forEach(function(i){var n,e,t="";0<i.bed.length&&(n=0,i.bed.forEach(function(e){n+=parseInt(e[2])}),t+='<div class="hci-tli">\n',t+='<img class="hci-icon" src="img/'+i.icon+'" alt />',t+='<div class="hci-text">'+n+"\u5f20"+i.name+"</div></div>",t+='<div class="hci-trli">',i.bed.forEach(function(e){t+='<div class="hci-trli-row"><span>('+i.list[e[1]]+")</span>&times;"+e[2]+"</div>"}),t+="</div></div>\n",(e=document.createElement("div")).classList.add("hci-tli-wrap"),e.classList.add("swiper-slide"),e.innerHTML=t,N.appendChild(e),M.update(),M.init())}),!s.baseHouseType||(L=s.baseHouseType.split(","))&&0<L.length&&(S="",L.forEach(function(e,i){e=e.split("-");0<e[1]&&(S+=e[1]+w[parseInt(e[0])],i+1<L.length&&(S+="/")),"2"===e[0]&&(k.q("#roomCount").innerText=e[1]),"1"===e[0]&&(b.innerText=e[1]),0===i&&e[2]&&(b.innerText=e[1]+"~"+e[2])}),k.q("#baseHouseType").innerText=S),l.style.display="flex",l.innerText="\u623f\u6e90\u5df2\u8ba4\u8bc1",l.classList.add("verified"),o.src=s.ownerAvatar,r.innerText=s.houseNo,d.innerText=s.profileStr,c.innerText=s.infoTitle,p.innerText=s.baseIndoorArea,u.innerText=s.baseOrientation,h.innerText=new Date(s.baseEstablishDate).getFullYear(),v.innerText=[null,"\u6574\u680b\u51fa\u79df","\u72ec\u7acb\u51fa\u79df","\u6574\u5957\u51fa\u79df"][s.profileRentMode],f.innerText=s.profileRentMode?"/"+k.s[s.profileRentMode]:"",g.innerText=s.ruleMonthMoney,x.innerText=s.infoBrief,k.judgeHeight(x),y.innerText=s.baseLiveNumber,s.ruleOtherMoneyDesc&&"undefined"!==s.ruleOtherMoneyDesc&&(q.innerText=s.ruleOtherMoneyDesc),phone.setAttribute("href","tel:"+s.rulePhone),T.addEventListener("click",function(){this.parentNode.parentNode.style.display="none"},!1);y=k.q(".rule-other"),q=k.q(".rule-pet"),T=k.q(".rule-party");s.ruleRequireJson?(y.innerText=s.ruleRequireJson,y.style.display="flex"):y.style.display="none",q.innerText=0===s.ruleIsAllowPet?"\u4e0d\u5141\u8bb8\u5e26\u5ba0\u7269":"\u5141\u8bb8\u5e26\u5ba0\u7269",T.innerText=0===s.ruleIsAllowParty?"\u4e0d\u5141\u8bb8\u4e3e\u529e\u6d3b\u52a8\u6216\u805a\u4f1a":"\u5141\u8bb8\u4e3e\u529e\u6d3b\u52a8\u6216\u805a\u4f1a",j.ajax({url:k.server[k.env]+"/xiangdao-api/api/house/faq_list",method:"POST",dataType:"json",async:!1,headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify({houseId:k.id,pageNo:1,pageSize:6}),success:function(e){console.log(e);var i=e.json.result;2<e.json.totalCount&&(2<i.length&&(i.length=2),j("#askShowAll").show());var a="";i&&0<i.length&&(k.q(".ask-nodata").style.display="none",i.forEach(function(e){var i,n,t="";0<e.replyCount&&(t+='<div class="ali-reply">\n                    <div class="ali-rep-t">\n                        <img class="ali-rep-avatar" src="'+e.lastReplyAvatar+'" alt />\n                        <div class="ali-rep-name">'+e.lastReplyNickName+'</div>\n                    </div>\n                    <div class="ali-rep-tit">'+e.lastReplyTitle+"</div>\n                </div>\n",1<e.replyCount&&(i=e.avatarUrl.split(","),n="",i&&0<i.length&&(i.shift(),4<i.length&&(i.length=4),i.forEach(function(e){n+='<img class="alp-avatar" src="'+e+'" alt />'})),t+='<div class="ali-rep-more">\n                    <div class="alp-avatars">\n'+n+'                    </div>\n                    <div class="alp-txt">'+e.lastReplyNickName+"\u7b49"+(e.replyCount-1)+"\u4eba\u4e5f\u8fdb\u884c\u4e86\u56de\u7b54</div>\n                </div>")),a+='<div class="ask-li" data-id="'+e.faqId+'">\n                <div class="ali-t">\n                    <img class="ali-avatar" src="'+e.avatar+'" alt />\n                    <div class="ali-name">'+e.nickName+'</div>\n                </div>\n                <div class="ali-tit">'+e.title+"</div>\n"+t+"            </div>"}),j("#askList").html(a))}}),0<s.baseCourtyardArea?(m.innerText=s.baseCourtyardArea,m.parentNode.parentNode.style.display="flex"):m.parentNode.parentNode.style.display="none",j.ajax({url:k.server[k.env]+"/xiangdao-api/api/houseEditor/get_house_icon_group",success:function(e){console.log(e);var i,a,e=e.json;e&&0<e.length&&(i="",i+='<div class="ist">\n',i+='<div class="ist-r">\n',a=s.profileHouseIcon.split(","),e.forEach(function(t){var e="";t.list.forEach(function(i){var n=!1;a&&0<a.length&&a.forEach(function(e){e=e.split("-");e[0]==t.type&&e[1]==i.iconSeq&&(n=!0)}),n&&(e+='<div class="ist-li '+(n?"sel":"")+'" data-id="'+i.iconSeq+'">'+i.iconName+"</div>")}),i+=e}),i+="</div>",i+="</div>",(e=k.q("#insWrap")).innerHTML=i,k.judgeHeight(e))}})}});var n=document.querySelectorAll(".pan-showall");if(n&&0<n.length)for(var t=0;t<n.length;t++)n[t].addEventListener("click",function(){var e=this.previousElementSibling;e&&e.classList.add("showAll"),this.style.display="none"},!1);var a=document.querySelectorAll(".pan-showall2");if(a&&0<a.length)for(var s=0;s<a.length;s++)a[s].addEventListener("click",function(){var e=this.previousElementSibling;"1"!==this.dataset.switch?(this.innerText="\u6536\u8d77 >>",this.dataset.switch="1",e&&e.classList.add("showAll")):(this.innerText="\u8be6\u60c5 >>",this.dataset.switch="0",e&&e.classList.remove("showAll"))},!1);var l=document.querySelectorAll(".link");if(l&&0<l.length)for(var o=0;o<l.length;o++)l[o].addEventListener("click",function(){openApp()},!1)});