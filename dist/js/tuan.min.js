require.config({paths:{common:"common.min",jquery:"jquery-3.2.1",swiper:"swiper.min"}}),define(["common","jquery","swiper"],function(g,y,e){g.init();var q={s:["","\u680b","\u95f4","\u5957","\u4eba"],tuan:[{id:1,key:"tuanPrice1",name:"\u5355\u4eba\u8ba2\u5e8a\u4f4d"},{id:2,key:"tuanPrice2",name:"\u5355\u4eba\u8ba2\u6574\u95f4"},{id:3,key:"tuanPrice3",name:"\u53cc\u4eba\u8ba2\u6574\u95f4"},{id:4,key:"tuanPrice4",name:"\u4e09\u4eba\u8ba2\u6574\u95f4"},{id:5,key:"tuanPrice5",name:"\u56db\u4eba\u8ba2\u6574\u95f4"}],env:"dev",server:{dev:"//dev.xiangdao.info",pro:"//www.xiangdao.info"},videoIndexArr:[]};q.id=g.parseQueryString().id;var w=new e(".swiper-container-bed",{slidesPerView:"auto",spaceBetween:30,init:!1});q.q=function(e){return document.querySelector(e)},q.judgeHeight=function(e){var i=e.clientHeight;e.style.height="auto",e.style.display="block",e.clientHeight<=i?e.nextElementSibling.style.display="none":e.removeAttribute("style")},q.init=function(){q.initData(),q.eventBind()},q.initData=function(){var m=q.q(".swiper-pagination"),f=new e(".swiper-container-head",{pagination:{el:".swiper-pagination",type:"fraction"},on:{transitionEnd:function(){var i=this;0<q.videoIndexArr.length?q.videoIndexArr.forEach(function(e){e.index===i.activeIndex?m.classList.add("video"):m.classList.remove("video")}):m.classList.remove("video");var e=document.querySelectorAll("video");if(e&&0<e.length)for(var n=0;n<e.length;n++)e[n].pause()}}});y.ajax({url:q.server[q.env]+"/xiangdao-api/api/tuan/tuan_details",method:"POST",dataType:"json",async:!1,headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify({tuanId:q.id}),success:function(e){var n,i,t,a,s,r,l,o,c,d,u,p,v,h;console.log(e),0===e.status&&(n=e.json,u=q.q("#baseLiveNumber"),i=q.q(".hc-ver"),t=q.q(".hc-tit"),e=q.q(".hc-tags"),i.style.display="flex",i.innerText="\u623f\u6e90\u5df2\u8ba4\u8bc1",i.classList.add("verified"),t.innerText=n.infoTitle,n.tagName&&(t=n.tagName.split(","),a="",t.forEach(function(e){a+='<div class="hc-tag">'+e+"</div>"}),e.innerHTML=a),s=[null,"\u5c42","\u5367","\u6d74","\u53a8","\u536b","\u5ba2\u5385","\u9910\u5385","\u4e66\u623f","\u9633\u53f0"],r=[{id:1,name:"\u5927\u5e8a",icon:"icon_bed.png",bed:[],list:[null,"2*1.8m","2*1.5m","1.8*1.5m","2*2m","2*1.6m","2.2*2.2m"]},{id:2,name:"\u5355\u4eba\u5e8a",icon:"icon_sbed.png",bed:[],list:[null,"2*1m","2*1.2m","1.9*2m","2*0.8m","2*1.35m","2*1.1m","2*1.3m"]},{id:3,name:"\u53cc\u5c42\u5e8a",icon:"icon_dbed.png",bed:[],list:[null,"0.9*1.9m\u4e0a\uff0c1.2*1.9m\u4e0b","1.2*1.9m\u4e0a\uff0c1.5*1.9m\u4e0b","1.35*1.9m\u4e0a\uff0c1.5*1.9m\u4e0b","0.9*1.8m","1*1.9m","1.2*1.9m","1.8*1.2m"]},{id:4,name:"\u6c99\u53d1\u5e8a",icon:"icon_sofa.png",bed:[],list:[null,"2*1.2m","2*1.5m"]},{id:5,name:"\u5706\u5e8a",icon:"icon_cbed.png",bed:[],list:[null,"\u76f4\u5f842m","\u76f4\u5f842.2m"]}],(l=n.baseHouseType.split(","))&&0<l.length&&(o="",l.forEach(function(e,i){e=e.split("-");0<e[1]&&(0===i&&e[2]?o+=e[1]+"~"+e[2]+s[parseInt(e[0])]:o+=e[1]+s[parseInt(e[0])],i+1<l.length&&(o+="/")),"2"===e[0]&&(q.q("#roomCount").innerText=e[1])}),q.q("#baseHouseType").innerText=o),!n.baseBedType||(d=n.baseBedType.split(","))&&0<d.length&&d.forEach(function(e){var i=e.split("-");r.forEach(function(e){parseInt(i[0])===e.id&&e.bed.push(i)})}),c=q.q("#hcInfo2"),r.forEach(function(i){var n,e,t="";0<i.bed.length&&(n=0,i.bed.forEach(function(e){n+=parseInt(e[2])}),t+='<div class="hci-tli">\n',t+='<img class="hci-icon" src="img/'+i.icon+'" alt />',t+='<div class="hci-text">'+n+"\u5f20"+i.name+"</div></div>",t+='<div class="hci-trli">',i.bed.forEach(function(e){t+='<div class="hci-trli-row"><span>('+i.list[e[1]]+")</span>&times;"+e[2]+"</div>"}),t+="</div></div>\n",(e=document.createElement("div")).classList.add("hci-tli-wrap"),e.classList.add("swiper-slide"),e.innerHTML=t,c.appendChild(e),w.update(),w.init())}),u.innerText=n.baseLiveNumber,e=q.q(".rule-other"),d=q.q(".rule-pet"),u=q.q(".rule-party"),n.ruleRequireJson?(e.innerText=n.ruleRequireJson,e.style.display="flex"):e.style.display="none",d.innerText=0===n.ruleIsAllowPet?"\u4e0d\u5141\u8bb8\u5e26\u5ba0\u7269":"\u5141\u8bb8\u5e26\u5ba0\u7269",u.innerText=0===n.ruleIsAllowParty?"\u4e0d\u5141\u8bb8\u4e3e\u529e\u6d3b\u52a8\u6216\u805a\u4f1a":"\u5141\u8bb8\u4e3e\u529e\u6d3b\u52a8\u6216\u805a\u4f1a",n.houseId&&g.request({url:q.server[q.env]+"/xiangdao-api/api/house/album_list/"+n.houseId,method:"GET",success:function(e){var t,i=e.json;i&&0<i.length&&(console.log(e),t="",i.forEach(function(n,e){var i;!n.url||0<(i=n.url.split(",")).length&&i.forEach(function(e,i){t+='<div class="swiper-slide">',1===n.type&&0===i?(t+='<video id="video'+n.id+'" class="head-video-li" preload="auto" controls  webkit-playsinline="true"\n playsinline="true"\n x5-playsinline="true"\n x5-video-player-type="h5"\n x5-video-player-fullscreen=""\n x5-video-orientation="portraint"\n x-webkit-airplay="true"\n controlsList="nodownload" controls="controls" src="'+e+'" poster="'+e+'?vframe/jpg/offset/2/w/640/h/360" />',q.videoIndexArr.push({index:i,item:e})):t+='<img class="head-img-li" src="'+e+'" alt />',t+="</div>"}),0===e&&1===n.type&&m.classList.add("video")}),q.q("#headImgs").innerHTML=t,f.update())}}),y.ajax({url:q.server[q.env]+"/xiangdao-api/api/houseEditor/get_house_icon_group",success:function(e){console.log(e);var i,a,e=e.json;e&&0<e.length&&(i="",i+='<div class="ist">\n',i+='<div class="ist-r">\n',a=n.profileHouseIcon.split(","),e.forEach(function(t){var e="";t.list.forEach(function(i){var n=!1;a&&0<a.length&&a.forEach(function(e){e=e.split("-");e[0]==t.type&&e[1]==i.iconSeq&&(n=!0)}),n&&(e+='<div class="ist-li '+(n?"sel":"")+'" data-id="'+i.iconSeq+'">'+i.iconName+"</div>")}),i+=e}),i+="</div>",i+="</div>",(e=q.q("#insWrap")).innerHTML=i,q.judgeHeight(e))}}),n.faqCount&&(y(".ask-nodata").hide(),2<=n.faqCount&&y("#askShowAll").show(),u='<div class="ask-li">\n                <div class="ali-t">\n                    <img class="ali-avatar" src="'+n.lastFaqAvatar+'" alt />\n                    <div class="ali-name">'+n.lastFaqNickName+'</div>\n                </div>\n                <div class="ali-tit">'+n.lastFaqTitle+"</div>\n            </div>",y("#askList").html(u)),q.q("#phone").setAttribute("href","tel:4006992388"),n.tuanNotice&&(q.q("#tuanNotice").innerHTML=n.tuanNotice),n.reserveTypeStr&&(p="",v=n.reserveTypeStr?n.reserveTypeStr.split(","):[],h=n.reserveTypeStatus?n.reserveTypeStatus.split(","):[],q.tuan.forEach(function(i){v.forEach(function(e){i.id===parseInt(e)&&(p+='<div class="st-li '+(0<n.isBookUp||0<h.length&&-1<h.indexOf(i.id.toString())?"":"st-se")+'" data-id="'+i.id+'">            <div class="st-l">                 <div class="st-t">'+i.name+'</div>                 <div class="st-b">\u9884\u8ba2\u4ef7: <i>\uffe5</i><span class="st-price" id="'+i.key+'">'+(n[i.key]?q.accMul(n[i.key],30):0)+'</span><span class="st-inf">'+(1===i.id?"\u4eba/\u6708/\u5e8a\u4f4d":"\u6708/\u6574\u95f4\u623f")+'/\u5305\u4e09\u9910</span></div>            </div>            <div class="st-r link">\u8ba2</div>       </div>')})}),q.q(".st-list").innerHTML=p))}})},q.eventBind=function(){var e=document.querySelectorAll(".pan-showall");if(e&&0<e.length)for(var i=0;i<e.length;i++)e[i].addEventListener("click",function(){var e=this.previousElementSibling;e&&e.classList.add("showAll"),this.style.display="none"},!1);var n=document.querySelectorAll(".pan-showall2");if(n&&0<n.length)for(var t=0;t<n.length;t++)n[t].addEventListener("click",function(){var e=this.previousElementSibling;"1"!==this.dataset.switch?(this.innerText="\u6536\u8d77 >>",this.dataset.switch="1",e&&e.classList.add("showAll")):(this.innerText="\u8be6\u60c5 >>",this.dataset.switch="0",e&&e.classList.remove("showAll"))},!1);var a=document.querySelectorAll(".link");if(a&&0<a.length)for(var s=0;s<a.length;s++)a[s].addEventListener("click",function(){openApp()},!1)},q.accMul=function(e,i){var n=0,e=e.toString(),i=i.toString();try{n+=e.split(".")[1].length}catch(e){}try{n+=i.split(".")[1].length}catch(e){}return Number(e.replace(".",""))*Number(i.replace(".",""))/Math.pow(10,n)},q.formatTime=function(e){var i=parseInt(e/86400),n=parseInt(e%86400/3600),t=parseInt(e%3600/60),e=parseInt(e%60);return{day:i,time:"<span>"+(n=n<10?"0"+n:n)+"</span>:<span>"+(t=t<10?"0"+t:t)+"</span>:<span>"+(e=e<10?"0"+e:e)+"</span>"}},q.parseTime=function(e){if(e){e=new Date(e);return e.getMonth()+1+"\u6708"+e.getDate()+"\u65e5"}return""},q.init()});